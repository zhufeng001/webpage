<!doctype html>
<!--[if lt IE 7]>   <html class="no-js ie6 lt-ie7 lt-ie8 lt-ie9">   <![endif]-->
<!--[if IE 7]>      <html class="no-js ie7 lt-ie8 lt-ie9">          <![endif]-->
<!--[if IE 8]>      <html class="no-js ie8 lt-ie9">                 <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en" dir="ltr">  <!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="prefetch" href="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">

    <meta name="application-name" content="Python.org">
    <meta name="msapplication-tooltip" content="The official home of the Python Programming Language">
    <meta name="apple-mobile-web-app-title" content="Python.org">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="HandheldFriendly" content="True">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cleartype" content="on">
    <meta http-equiv="imagetoolbar" content="false">

    <script src="/static/js/libs/modernizr.js"></script>

    <link href="/static/stylesheets/style.css" rel="stylesheet" type="text/css" title="default" />
    <link href="/static/stylesheets/mq.css" rel="stylesheet" type="text/css" media="not print, braille, embossed, speech, tty" />
    

    <!--[if (lte IE 8)&(!IEMobile)]>
    <link href="/static/stylesheets/no-mq.css" rel="stylesheet" type="text/css" media="screen" />
    
    
    <![endif]-->

    
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/static/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/static/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/static/apple-touch-icon-precomposed.png">
    <link rel="apple-touch-icon" href="/static/apple-touch-icon-precomposed.png">

    
    <meta name="msapplication-TileImage" content="/static/metro-icon-144x144-precomposed.png"><!-- white shape -->
    <meta name="msapplication-TileColor" content="#3673a5"><!-- python blue -->
    <meta name="msapplication-navbutton-color" content="#3673a5">

    <meta property="og:site_name" content="Python.org">
    <meta property="og:type" content="website">

    <title>PEP 333 - Python Web Server Gateway Interface v1.0 | Python.org</title>
    <meta property="og:title" content="Welcome to Python.org">

    
    <meta name="description" content="The official home of the Python Programming Language">
    <meta name="og:description" content="The official home of the Python Programming Language">
    <meta name="keywords" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:tag" content="Python programming language object oriented web free open source software license documentation download community">
    <meta property="og:published_time" content="">
    <meta property="og:modified_time" content="">
    <meta property="og:author" content="">
    <meta property="og:section" content=""> 
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <meta property="og:video" content="">

    <link rel="author" href="/static/humans.txt">

    

    
    <script type="application/ld+json">
     {
       "@context": "http://schema.org",
       "@type": "WebSite",
       "url": "https://www.python.org/",
       "potentialAction": {
         "@type": "SearchAction",
         "target": "https://www.python.org/search/?q={search_term_string}",
         "query-input": "required name=search_term_string"
       }
     }
    </script>

    
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39055973-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    
</head>

<body class="python pages pep-page">

    <div id="touchnav-wrapper">

        <!-- Sister Site Links -->
        <div id="top" class="top-bar do-not-print">

            <nav class="meta-navigation container" role="navigation">

                
                <div class="skip-link screen-reader-text">
                    <a href="#content" title="Skip to content">Skip to content</a>
                </div>

                
                <a id="close-python-network" class="jump-link" href="#python-network" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-down"><span>&#9660;</span></span> Close
                </a>

                

<ul class="menu" role="tree">
    
    <li class="python-meta ">
        <a href="/" title="The Python Programming Language" >Python</a>
    </li>
    
    <li class="psf-meta ">
        <a href="/psf-landing/" title="The Python Software Foundation" >PSF</a>
    </li>
    
    <li class="docs-meta ">
        <a href="https://docs.python.org" title="Python Documentation" >Docs</a>
    </li>
    
    <li class="pypi-meta ">
        <a href="https://pypi.python.org/" title="Python Package Index" >PyPI</a>
    </li>
    
    <li class="jobs-meta ">
        <a href="/jobs/" title="Python Job Board" >Jobs</a>
    </li>
    
    <li class="shop-meta ">
        <a href="/community/" title="Python Community" >Community</a>
    </li>
    
</ul>


                <a id="python-network" class="jump-link" href="#top" aria-hidden="true">
                    <span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> The Python Network
                </a>

            </nav>

        </div>

        <!-- Header elements -->
        <header class="main-header" role="banner">
            <div class="container">

                <h1 class="site-headline">
                    <a href="/"><img class="python-logo" src="/static/img/python-logo.png" alt="python&trade;"></a>
                </h1>

                <div class="options-bar do-not-print">

                    
                    <a id="site-map-link" class="jump-to-menu" href="#site-map"><span class="menu-icon">&equiv;</span> Menu</a><form class="search-the-site" action="/search/" method="get">
                        <fieldset title="Search Python.org">

                            <span aria-hidden="true" class="icon-search"></span>

                            <label class="screen-reader-text" for="id-search-field">Search This Site</label>
                            <input id="id-search-field" name="q" type="search" role="textbox" class="search-field" placeholder="Search" value="" tabindex="1">

                            <button type="submit" name="submit" id="submit" class="search-button" title="Submit this Search" tabindex="3">
                                GO
                            </button>

                            
                            <!--[if IE]><input type="text" style="display: none;" disabled="disabled" size="1" tabindex="4"><![endif]-->

                        </fieldset>
                    </form><span class="breaker"></span><div class="adjust-font-size" aria-hidden="true">
                        <ul class="navigation menu" aria-label="Adjust Text Size on Page">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger"><strong><small>A</small> A</strong></a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a class="text-shrink" title="Make Text Smaller" href="javascript:;">Smaller</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a class="text-grow" title="Make Text Larger" href="javascript:;">Larger</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a class="text-reset" title="Reset any font size changes I have made" href="javascript:;">Reset</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="winkwink-nudgenudge">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                <a href="#" class="action-trigger">Socialize</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="http://plus.google.com/+Python"><span aria-hidden="true" class="icon-google-plus"></span>Google+</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="http://www.facebook.com/pythonlang?fref=ts"><span aria-hidden="true" class="icon-facebook"></span>Facebook</a></li>
                                    <li class="tier-2 element-3" role="treeitem"><a href="http://twitter.com/ThePSF"><span aria-hidden="true" class="icon-twitter"></span>Twitter</a></li>
                                    <li class="tier-2 element-4" role="treeitem"><a href="/community/irc/"><span aria-hidden="true" class="icon-freenode"></span>Chat on IRC</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><div class="account-signin">
                        <ul class="navigation menu" aria-label="Social Media Navigation">
                            <li class="tier-1 last" aria-haspopup="true">
                                
                                <a href="/accounts/login/" title="Sign Up or Sign In to Python.org">Sign In</a>
                                <ul class="subnav menu">
                                    <li class="tier-2 element-1" role="treeitem"><a href="/accounts/signup/">Sign Up / Register</a></li>
                                    <li class="tier-2 element-2" role="treeitem"><a href="/accounts/login/">Sign In</a></li>
                                </ul>
                                
                            </li>
                        </ul>
                    </div>

                </div><!-- end options-bar -->

                <nav id="mainnav" class="python-navigation main-navigation do-not-print" role="navigation">
                    
                        
<ul class="navigation menu" role="menubar" aria-label="Main Navigation">
  
    
    
    <li id="about" class="tier-1 element-1  " aria-haspopup="true">
        <a href="/about/" title="" class="">About</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="downloads" class="tier-1 element-2  " aria-haspopup="true">
        <a href="/downloads/" title="" class="">Downloads</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="documentation" class="tier-1 element-3  " aria-haspopup="true">
        <a href="/doc/" title="" class="">Documentation</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="http://python.org/dev/peps/" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="community" class="tier-1 element-4  " aria-haspopup="true">
        <a href="/community/" title="" class="">Community</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="success-stories" class="tier-1 element-5  " aria-haspopup="true">
        <a href="/about/success/" title="success-stories" class="">Success Stories</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="news" class="tier-1 element-6  " aria-haspopup="true">
        <a href="/blogs/" title="News from around the Python world" class="">News</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    
    
    <li id="events" class="tier-1 element-7  " aria-haspopup="true">
        <a href="/events/python-events/" title="" class="">Events</a>
        
            

<ul class="subnav menu" role="menu" aria-hidden="true">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    
    
    
  
</ul>

                    
                </nav>

                <div class="header-banner "> <!-- for optional "do-not-print" class -->
                    
                    
                </div>

                
                

             </div><!-- end .container -->
        </header>

        <div id="content" class="content-wrapper">
            <!-- Main Content Column -->
            <div class="container">

                <section class="main-content with-left-sidebar" role="main">

                    
<ul class="breadcrumbs menu">
    <li>
        <a href="/" title="The Python Programming Language">Python</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="/dev/">Python Developer's Guide</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>
        <a href="/dev/peps/">PEP Index</a><span class="prompt">&gt;&gt;&gt;</span>
    </li>
    <li>PEP 333 - Python Web Server Gateway Interface v1.0</li>
</ul>


                    
<style>
   .pep-page pre {
        padding: .5em;
        background: inherit;
        border-left: 0px;
        -webkit-box-shadow: 0 0 0 0;
        -moz-box-shadow: 0 0 0 0;
        box-shadow: 0 0 0 0;
   }
</style>

    
    <article class="text">
        

        <header class="article-header">
            <h1 class="page-title">PEP 333 - Python Web Server Gateway Interface v1.0</h1>
        </header>

        <!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/dev/peps/pep-0001 for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<html>
 <body>
  <table class="rfc2822 docutils field-list" frame="void" rules="none">
   <col class="field-name">
   </col>
   <col class="field-body">
   </col>
   <tbody valign="top">
    <tr class="field">
     <th class="field-name">
      PEP:
     </th>
     <td class="field-body">
      333
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Title:
     </th>
     <td class="field-body">
      Python Web Server Gateway Interface v1.0
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Author:
     </th>
     <td class="field-body">
      Phillip J. Eby &lt;pje at telecommunity.com&gt;
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Discussions-To:
     </th>
     <td class="field-body">
      Python Web-SIG &lt;
      <a class="reference external" href="mailto:web-sig@python.org?subject=PEP%20333">
       web-sig at python.org
      </a>
      &gt;
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Status:
     </th>
     <td class="field-body">
      Final
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Type:
     </th>
     <td class="field-body">
      Informational
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Created:
     </th>
     <td class="field-body">
      07-Dec-2003
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Post-History:
     </th>
     <td class="field-body">
      07-Dec-2003, 08-Aug-2004, 20-Aug-2004, 27-Aug-2004, 27-Sep-2010
     </td>
    </tr>
    <tr class="field">
     <th class="field-name">
      Superseded-By:
     </th>
     <td class="field-body">
      3333
     </td>
    </tr>
   </tbody>
  </table>
  <hr/>
  <div class="contents topic" id="contents">
   <p class="topic-title first">
    Contents
   </p>
   <ul class="simple">
    <li>
     <a class="reference internal" href="#preface" id="id11">
      Preface
     </a>
    </li>
    <li>
     <a class="reference internal" href="#abstract" id="id12">
      Abstract
     </a>
    </li>
    <li>
     <a class="reference internal" href="#rationale-and-goals" id="id13">
      Rationale and Goals
     </a>
    </li>
    <li>
     <a class="reference internal" href="#specification-overview" id="id14">
      Specification Overview
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#the-application-framework-side" id="id15">
        The Application/Framework Side
       </a>
      </li>
      <li>
       <a class="reference internal" href="#the-server-gateway-side" id="id16">
        The Server/Gateway Side
       </a>
      </li>
      <li>
       <a class="reference internal" href="#middleware-components-that-play-both-sides" id="id17">
        Middleware: Components that Play Both Sides
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#specification-details" id="id18">
      Specification Details
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#environ-variables" id="id19">
        <tt class="docutils literal">
         environ
        </tt>
        Variables
       </a>
       <ul>
        <li>
         <a class="reference internal" href="#input-and-error-streams" id="id20">
          Input and Error Streams
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="reference internal" href="#the-start-response-callable" id="id21">
        The
        <tt class="docutils literal">
         start_response()
        </tt>
        Callable
       </a>
       <ul>
        <li>
         <a class="reference internal" href="#handling-the-content-length-header" id="id22">
          Handling the
          <tt class="docutils literal">
           <span class="pre">
            Content-Length
           </span>
          </tt>
          Header
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="reference internal" href="#buffering-and-streaming" id="id23">
        Buffering and Streaming
       </a>
       <ul>
        <li>
         <a class="reference internal" href="#middleware-handling-of-block-boundaries" id="id24">
          Middleware Handling of Block Boundaries
         </a>
        </li>
        <li>
         <a class="reference internal" href="#the-write-callable" id="id25">
          The
          <tt class="docutils literal">
           write()
          </tt>
          Callable
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="reference internal" href="#unicode-issues" id="id26">
        Unicode Issues
       </a>
      </li>
      <li>
       <a class="reference internal" href="#error-handling" id="id27">
        Error Handling
       </a>
      </li>
      <li>
       <a class="reference internal" href="#http-1-1-expect-continue" id="id28">
        HTTP 1.1 Expect/Continue
       </a>
      </li>
      <li>
       <a class="reference internal" href="#other-http-features" id="id29">
        Other HTTP Features
       </a>
      </li>
      <li>
       <a class="reference internal" href="#thread-support" id="id30">
        Thread Support
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#implementation-application-notes" id="id31">
      Implementation/Application Notes
     </a>
     <ul>
      <li>
       <a class="reference internal" href="#server-extension-apis" id="id32">
        Server Extension APIs
       </a>
      </li>
      <li>
       <a class="reference internal" href="#application-configuration" id="id33">
        Application Configuration
       </a>
      </li>
      <li>
       <a class="reference internal" href="#url-reconstruction" id="id34">
        URL Reconstruction
       </a>
      </li>
      <li>
       <a class="reference internal" href="#supporting-older-2-2-versions-of-python" id="id35">
        Supporting Older (&lt;2.2) Versions of Python
       </a>
      </li>
      <li>
       <a class="reference internal" href="#optional-platform-specific-file-handling" id="id36">
        Optional Platform-Specific File Handling
       </a>
      </li>
     </ul>
    </li>
    <li>
     <a class="reference internal" href="#questions-and-answers" id="id37">
      Questions and Answers
     </a>
    </li>
    <li>
     <a class="reference internal" href="#proposed-under-discussion" id="id38">
      Proposed/Under Discussion
     </a>
    </li>
    <li>
     <a class="reference internal" href="#acknowledgements" id="id39">
      Acknowledgements
     </a>
    </li>
    <li>
     <a class="reference internal" href="#references" id="id40">
      References
     </a>
    </li>
    <li>
     <a class="reference internal" href="#copyright" id="id41">
      Copyright
     </a>
    </li>
   </ul>
  </div>
  <div class="section" id="preface">
   <h1>
    <a class="toc-backref" href="#id11">
     Preface
    </a>
   </h1>
   <p>
    Note: For an updated version of this spec that supports Python 3.x and
includes community errata, addenda, and clarifications, please
see
    <a class="reference external" href="/dev/peps/pep-3333">
     PEP 3333
    </a>
    instead.
   </p>
  </div>
  <div class="section" id="abstract">
   <h1>
    <a class="toc-backref" href="#id12">
     Abstract
    </a>
   </h1>
   <p>
    This document specifies a proposed standard interface between web
servers and Python web applications or frameworks, to promote web
application portability across a variety of web servers.
   </p>
  </div>
  <div class="section" id="rationale-and-goals">
   <h1>
    <a class="toc-backref" href="#id13">
     Rationale and Goals
    </a>
   </h1>
   <p>
    Python currently boasts a wide variety of web application frameworks,
such as Zope, Quixote, Webware, SkunkWeb, PSO, and Twisted Web -- to
name just a few
    <a class="footnote-reference" href="#id6" id="id1">
     [1]
    </a>
    .  This wide variety of choices can be a problem
for new Python users, because generally speaking, their choice of web
framework will limit their choice of usable web servers, and vice
versa.
   </p>
   <p>
    By contrast, although Java has just as many web application frameworks
available, Java's "servlet" API makes it possible for applications
written with any Java web application framework to run in any web
server that supports the servlet API.
   </p>
   <p>
    The availability and widespread use of such an API in web servers for
Python -- whether those servers are written in Python (e.g. Medusa),
embed Python (e.g. mod_python), or invoke Python via a gateway
protocol (e.g. CGI, FastCGI, etc.) -- would separate choice of
framework from choice of web server, freeing users to choose a pairing
that suits them, while freeing framework and server developers to
focus on their preferred area of specialization.
   </p>
   <p>
    This PEP, therefore, proposes a simple and universal interface between
web servers and web applications or frameworks: the Python Web Server
Gateway Interface (WSGI).
   </p>
   <p>
    But the mere existence of a WSGI spec does nothing to address the
existing state of servers and frameworks for Python web applications.
Server and framework authors and maintainers must actually implement
WSGI for there to be any effect.
   </p>
   <p>
    However, since no existing servers or frameworks support WSGI, there
is little immediate reward for an author who implements WSGI support.
Thus, WSGI
    <strong>
     must
    </strong>
    be easy to implement, so that an author's initial
investment in the interface can be reasonably low.
   </p>
   <p>
    Thus, simplicity of implementation on
    <em>
     both
    </em>
    the server and framework
sides of the interface is absolutely critical to the utility of the
WSGI interface, and is therefore the principal criterion for any
design decisions.
   </p>
   <p>
    Note, however, that simplicity of implementation for a framework
author is not the same thing as ease of use for a web application
author.  WSGI presents an absolutely "no frills" interface to the
framework author, because bells and whistles like response objects and
cookie handling would just get in the way of existing frameworks'
handling of these issues.  Again, the goal of WSGI is to facilitate
easy interconnection of existing servers and applications or
frameworks, not to create a new web framework.
   </p>
   <p>
    Note also that this goal precludes WSGI from requiring anything that
is not already available in deployed versions of Python.  Therefore,
new standard library modules are not proposed or required by this
specification, and nothing in WSGI requires a Python version greater
than 2.2.2.  (It would be a good idea, however, for future versions
of Python to include support for this interface in web servers
provided by the standard library.)
   </p>
   <p>
    In addition to ease of implementation for existing and future
frameworks and servers, it should also be easy to create request
preprocessors, response postprocessors, and other WSGI-based
"middleware" components that look like an application to their
containing server, while acting as a server for their contained
applications.
   </p>
   <p>
    If middleware can be both simple and robust, and WSGI is widely
available in servers and frameworks, it allows for the possibility
of an entirely new kind of Python web application framework: one
consisting of loosely-coupled WSGI middleware components.  Indeed,
existing framework authors may even choose to refactor their
frameworks' existing services to be provided in this way, becoming
more like libraries used with WSGI, and less like monolithic
frameworks.  This would then allow application developers to choose
"best-of-breed" components for specific functionality, rather than
having to commit to all the pros and cons of a single framework.
   </p>
   <p>
    Of course, as of this writing, that day is doubtless quite far off.
In the meantime, it is a sufficient short-term goal for WSGI to
enable the use of any framework with any server.
   </p>
   <p>
    Finally, it should be mentioned that the current version of WSGI
does not prescribe any particular mechanism for "deploying" an
application for use with a web server or server gateway.  At the
present time, this is necessarily implementation-defined by the
server or gateway.  After a sufficient number of servers and
frameworks have implemented WSGI to provide field experience with
varying deployment requirements, it may make sense to create
another PEP, describing a deployment standard for WSGI servers and
application frameworks.
   </p>
  </div>
  <div class="section" id="specification-overview">
   <h1>
    <a class="toc-backref" href="#id14">
     Specification Overview
    </a>
   </h1>
   <p>
    The WSGI interface has two sides: the "server" or "gateway" side, and
the "application" or "framework" side.  The server side invokes a
callable object that is provided by the application side.  The
specifics of how that object is provided are up to the server or
gateway.  It is assumed that some servers or gateways will require an
application's deployer to write a short script to create an instance
of the server or gateway, and supply it with the application object.
Other servers and gateways may use configuration files or other
mechanisms to specify where an application object should be
imported from, or otherwise obtained.
   </p>
   <p>
    In addition to "pure" servers/gateways and applications/frameworks,
it is also possible to create "middleware" components that implement
both sides of this specification.  Such components act as an
application to their containing server, and as a server to a
contained application, and can be used to provide extended APIs,
content transformation, navigation, and other useful functions.
   </p>
   <p>
    Throughout this specification, we will use the term "a callable" to
mean "a function, method, class, or an instance with a
    <tt class="docutils literal">
     __call__
    </tt>
    method".  It is up to the server, gateway, or application implementing
the callable to choose the appropriate implementation technique for
their needs.  Conversely, a server, gateway, or application that is
invoking a callable
    <strong>
     must not
    </strong>
    have any dependency on what kind of
callable was provided to it.  Callables are only to be called, not
introspected upon.
   </p>
   <div class="section" id="the-application-framework-side">
    <h2>
     <a class="toc-backref" href="#id15">
      The Application/Framework Side
     </a>
    </h2>
    <p>
     The application object is simply a callable object that accepts
two arguments.  The term "object" should not be misconstrued as
requiring an actual object instance: a function, method, class,
or instance with a
     <tt class="docutils literal">
      __call__
     </tt>
     method are all acceptable for
use as an application object.  Application objects must be able
to be invoked more than once, as virtually all servers/gateways
(other than CGI) will make such repeated requests.
    </p>
    <p>
     (Note: although we refer to it as an "application" object, this
should not be construed to mean that application developers will use
WSGI as a web programming API!  It is assumed that application
developers will continue to use existing, high-level framework
services to develop their applications.  WSGI is a tool for
framework and server developers, and is not intended to directly
support application developers.)
    </p>
    <p>
     Here are two example application objects; one is a function, and the
other is a class:
    </p>
    <pre class="literal-block">
def simple_app(environ, start_response):
    """Simplest possible application object"""
    status = '200 OK'
    response_headers = [('Content-type', 'text/plain')]
    start_response(status, response_headers)
    return ['Hello world!\n']


class AppClass:
    """Produce the same output, but using a class

    (Note: 'AppClass' is the "application" here, so calling it
    returns an instance of 'AppClass', which is then the iterable
    return value of the "application callable" as required by
    the spec.

    If we wanted to use *instances* of 'AppClass' as application
    objects instead, we would have to implement a '__call__'
    method, which would be invoked to execute the application,
    and we would need to create an instance for use by the
    server or gateway.
    """

    def __init__(self, environ, start_response):
        self.environ = environ
        self.start = start_response

    def __iter__(self):
        status = '200 OK'
        response_headers = [('Content-type', 'text/plain')]
        self.start(status, response_headers)
        yield "Hello world!\n"
</pre>
   </div>
   <div class="section" id="the-server-gateway-side">
    <h2>
     <a class="toc-backref" href="#id16">
      The Server/Gateway Side
     </a>
    </h2>
    <p>
     The server or gateway invokes the application callable once for each
request it receives from an HTTP client, that is directed at the
application.  To illustrate, here is a simple CGI gateway, implemented
as a function taking an application object.  Note that this simple
example has limited error handling, because by default an uncaught
exception will be dumped to
     <tt class="docutils literal">
      sys.stderr
     </tt>
     and logged by the web
server.
    </p>
    <pre class="literal-block">
import os, sys

def run_with_cgi(application):

    environ = dict(os.environ.items())
    environ['wsgi.input']        = sys.stdin
    environ['wsgi.errors']       = sys.stderr
    environ['wsgi.version']      = (1, 0)
    environ['wsgi.multithread']  = False
    environ['wsgi.multiprocess'] = True
    environ['wsgi.run_once']     = True

    if environ.get('HTTPS', 'off') in ('on', '1'):
        environ['wsgi.url_scheme'] = 'https'
    else:
        environ['wsgi.url_scheme'] = 'http'

    headers_set = []
    headers_sent = []

    def write(data):
        if not headers_set:
             raise AssertionError("write() before start_response()")

        elif not headers_sent:
             # Before the first output, send the stored headers
             status, response_headers = headers_sent[:] = headers_set
             sys.stdout.write('Status: %s\r\n' % status)
             for header in response_headers:
                 sys.stdout.write('%s: %s\r\n' % header)
             sys.stdout.write('\r\n')

        sys.stdout.write(data)
        sys.stdout.flush()

    def start_response(status, response_headers, exc_info=None):
        if exc_info:
            try:
                if headers_sent:
                    # Re-raise original exception if headers sent
                    raise exc_info[0], exc_info[1], exc_info[2]
            finally:
                exc_info = None     # avoid dangling circular ref
        elif headers_set:
            raise AssertionError("Headers already set!")

        headers_set[:] = [status, response_headers]
        return write

    result = application(environ, start_response)
    try:
        for data in result:
            if data:    # don't send headers until body appears
                write(data)
        if not headers_sent:
            write('')   # send headers now if body was empty
    finally:
        if hasattr(result, 'close'):
            result.close()
</pre>
   </div>
   <div class="section" id="middleware-components-that-play-both-sides">
    <h2>
     <a class="toc-backref" href="#id17">
      Middleware: Components that Play Both Sides
     </a>
    </h2>
    <p>
     Note that a single object may play the role of a server with respect
to some application(s), while also acting as an application with
respect to some server(s).  Such "middleware" components can perform
such functions as:
    </p>
    <ul class="simple">
     <li>
      Routing a request to different application objects based on the
target URL, after rewriting the
      <tt class="docutils literal">
       environ
      </tt>
      accordingly.
     </li>
     <li>
      Allowing multiple applications or frameworks to run side-by-side
in the same process
     </li>
     <li>
      Load balancing and remote processing, by forwarding requests and
responses over a network
     </li>
     <li>
      Perform content postprocessing, such as applying XSL stylesheets
     </li>
    </ul>
    <p>
     The presence of middleware in general is transparent to both the
"server/gateway" and the "application/framework" sides of the
interface, and should require no special support.  A user who
desires to incorporate middleware into an application simply
provides the middleware component to the server, as if it were
an application, and configures the middleware component to
invoke the application, as if the middleware component were a
server.  Of course, the "application" that the middleware wraps
may in fact be another middleware component wrapping another
application, and so on, creating what is referred to as a
"middleware stack".
    </p>
    <p>
     For the most part, middleware must conform to the restrictions
and requirements of both the server and application sides of
WSGI.  In some cases, however, requirements for middleware
are more stringent than for a "pure" server or application,
and these points will be noted in the specification.
    </p>
    <p>
     Here is a (tongue-in-cheek) example of a middleware component that
converts
     <tt class="docutils literal">
      text/plain
     </tt>
     responses to pig latin, using Joe Strout's
     <tt class="docutils literal">
      piglatin.py
     </tt>
     .  (Note: a "real" middleware component would
probably use a more robust way of checking the content type, and
should also check for a content encoding.  Also, this simple
example ignores the possibility that a word might be split across
a block boundary.)
    </p>
    <pre class="literal-block">
from piglatin import piglatin

class LatinIter:

    """Transform iterated output to piglatin, if it's okay to do so

    Note that the "okayness" can change until the application yields
    its first non-empty string, so 'transform_ok' has to be a mutable
    truth value.
    """

    def __init__(self, result, transform_ok):
        if hasattr(result, 'close'):
            self.close = result.close
        self._next = iter(result).next
        self.transform_ok = transform_ok

    def __iter__(self):
        return self

    def next(self):
        if self.transform_ok:
            return piglatin(self._next())
        else:
            return self._next()

class Latinator:

    # by default, don't transform output
    transform = False

    def __init__(self, application):
        self.application = application

    def __call__(self, environ, start_response):

        transform_ok = []

        def start_latin(status, response_headers, exc_info=None):

            # Reset ok flag, in case this is a repeat call
            del transform_ok[:]

            for name, value in response_headers:
                if name.lower() == 'content-type' and value == 'text/plain':
                    transform_ok.append(True)
                    # Strip content-length if present, else it'll be wrong
                    response_headers = [(name, value)
                        for name, value in response_headers
                            if name.lower() != 'content-length'
                    ]
                    break

            write = start_response(status, response_headers, exc_info)

            if transform_ok:
                def write_latin(data):
                    write(piglatin(data))
                return write_latin
            else:
                return write

        return LatinIter(self.application(environ, start_latin), transform_ok)


# Run foo_app under a Latinator's control, using the example CGI gateway
from foo_app import foo_app
run_with_cgi(Latinator(foo_app))
</pre>
   </div>
  </div>
  <div class="section" id="specification-details">
   <h1>
    <a class="toc-backref" href="#id18">
     Specification Details
    </a>
   </h1>
   <p>
    The application object must accept two positional arguments.  For
the sake of illustration, we have named them
    <tt class="docutils literal">
     environ
    </tt>
    and
    <tt class="docutils literal">
     start_response
    </tt>
    , but they are not required to have these names.
A server or gateway
    <strong>
     must
    </strong>
    invoke the application object using
positional (not keyword) arguments.  (E.g. by calling
    <tt class="docutils literal">
     result = application(environ, start_response)
    </tt>
    as shown above.)
   </p>
   <p>
    The
    <tt class="docutils literal">
     environ
    </tt>
    parameter is a dictionary object, containing CGI-style
environment variables.  This object
    <strong>
     must
    </strong>
    be a builtin Python
dictionary (
    <em>
     not
    </em>
    a subclass,
    <tt class="docutils literal">
     UserDict
    </tt>
    or other dictionary
emulation), and the application is allowed to modify the dictionary
in any way it desires.  The dictionary must also include certain
WSGI-required variables (described in a later section), and may
also include server-specific extension variables, named according
to a convention that will be described below.
   </p>
   <p>
    The
    <tt class="docutils literal">
     start_response
    </tt>
    parameter is a callable accepting two
required positional arguments, and one optional argument.  For the sake
of illustration, we have named these arguments
    <tt class="docutils literal">
     status
    </tt>
    ,
    <tt class="docutils literal">
     response_headers
    </tt>
    , and
    <tt class="docutils literal">
     exc_info
    </tt>
    , but they are not required to
have these names, and the application
    <strong>
     must
    </strong>
    invoke the
    <tt class="docutils literal">
     start_response
    </tt>
    callable using positional arguments (e.g.
    <tt class="docutils literal">
     start_response(status, response_headers)
    </tt>
    ).
   </p>
   <p>
    The
    <tt class="docutils literal">
     status
    </tt>
    parameter is a status string of the form
    <tt class="docutils literal">
     "999 Message here"
    </tt>
    , and
    <tt class="docutils literal">
     response_headers
    </tt>
    is a list of
    <tt class="docutils literal">
     (header_name, header_value)
    </tt>
    tuples describing the HTTP response
header.  The optional
    <tt class="docutils literal">
     exc_info
    </tt>
    parameter is described below in the
sections on
    <a class="reference internal" href="#the-start-response-callable">
     The start_response() Callable
    </a>
    and
    <a class="reference internal" href="#error-handling">
     Error Handling
    </a>
    .
It is used only when the application has trapped an error and is
attempting to display an error message to the browser.
   </p>
   <p>
    The
    <tt class="docutils literal">
     start_response
    </tt>
    callable must return a
    <tt class="docutils literal">
     write(body_data)
    </tt>
    callable that takes one positional parameter: a string to be written
as part of the HTTP response body.  (Note: the
    <tt class="docutils literal">
     write()
    </tt>
    callable is
provided only to support certain existing frameworks' imperative output
APIs; it should not be used by new applications or frameworks if it
can be avoided.  See the
    <a class="reference internal" href="#buffering-and-streaming">
     Buffering and Streaming
    </a>
    section for more
details.)
   </p>
   <p>
    When called by the server, the application object must return an
iterable yielding zero or more strings.  This can be accomplished in a
variety of ways, such as by returning a list of strings, or by the
application being a generator function that yields strings, or
by the application being a class whose instances are iterable.
Regardless of how it is accomplished, the application object must
always return an iterable yielding zero or more strings.
   </p>
   <p>
    The server or gateway must transmit the yielded strings to the client
in an unbuffered fashion, completing the transmission of each string
before requesting another one.  (In other words, applications
    <strong>
     should
    </strong>
    perform their own buffering.  See the
    <a class="reference internal" href="#buffering-and-streaming">
     Buffering and
Streaming
    </a>
    section below for more on how application output must be
handled.)
   </p>
   <p>
    The server or gateway should treat the yielded strings as binary byte
sequences: in particular, it should ensure that line endings are
not altered.  The application is responsible for ensuring that the
string(s) to be written are in a format suitable for the client.  (The
server or gateway
    <strong>
     may
    </strong>
    apply HTTP transfer encodings, or perform
other transformations for the purpose of implementing HTTP features
such as byte-range transmission.  See
    <a class="reference internal" href="#other-http-features">
     Other HTTP Features
    </a>
    , below,
for more details.)
   </p>
   <p>
    If a call to
    <tt class="docutils literal">
     len(iterable)
    </tt>
    succeeds, the server must be able
to rely on the result being accurate.  That is, if the iterable
returned by the application provides a working
    <tt class="docutils literal">
     __len__()
    </tt>
    method, it
    <strong>
     must
    </strong>
    return an accurate result.  (See
the
    <a class="reference internal" href="#handling-the-content-length-header">
     Handling the Content-Length Header
    </a>
    section for information
on how this would normally be used.)
   </p>
   <p>
    If the iterable returned by the application has a
    <tt class="docutils literal">
     close()
    </tt>
    method,
the server or gateway
    <strong>
     must
    </strong>
    call that method upon completion of the
current request, whether the request was completed normally, or
terminated early due to an error.  (This is to support resource release
by the application.  This protocol is intended to complement
    <a class="reference external" href="/dev/peps/pep-0325">
     PEP 325
    </a>
    's
generator support, and other common iterables with
    <tt class="docutils literal">
     close()
    </tt>
    methods.
   </p>
   <p>
    (Note: the application
    <strong>
     must
    </strong>
    invoke the
    <tt class="docutils literal">
     start_response()
    </tt>
    callable before the iterable yields its first body string, so that the
server can send the headers before any body content.  However, this
invocation
    <strong>
     may
    </strong>
    be performed by the iterable's first iteration, so
servers
    <strong>
     must not
    </strong>
    assume that
    <tt class="docutils literal">
     start_response()
    </tt>
    has been called
before they begin iterating over the iterable.)
   </p>
   <p>
    Finally, servers and gateways
    <strong>
     must not
    </strong>
    directly use any other
attributes of the iterable returned by the application, unless it is an
instance of a type specific to that server or gateway, such as a "file
wrapper" returned by
    <tt class="docutils literal">
     wsgi.file_wrapper
    </tt>
    (see
    <a class="reference internal" href="#optional-platform-specific-file-handling">
     Optional
Platform-Specific File Handling
    </a>
    ).  In the general case, only
attributes specified here, or accessed via e.g. the
    <a class="reference external" href="/dev/peps/pep-0234">
     PEP 234
    </a>
    iteration
APIs are acceptable.
   </p>
   <div class="section" id="environ-variables">
    <h2>
     <a class="toc-backref" href="#id19">
      <tt class="docutils literal">
       environ
      </tt>
      Variables
     </a>
    </h2>
    <p>
     The
     <tt class="docutils literal">
      environ
     </tt>
     dictionary is required to contain these CGI
environment variables, as defined by the Common Gateway Interface
specification
     <a class="footnote-reference" href="#id7" id="id2">
      [2]
     </a>
     .  The following variables
     <strong>
      must
     </strong>
     be present,
unless their value would be an empty string, in which case they
     <strong>
      may
     </strong>
     be omitted, except as otherwise noted below.
    </p>
    <dl class="docutils">
     <dt>
      <tt class="docutils literal">
       REQUEST_METHOD
      </tt>
     </dt>
     <dd>
      The HTTP request method, such as
      <tt class="docutils literal">
       "GET"
      </tt>
      or
      <tt class="docutils literal">
       "POST"
      </tt>
      .  This
cannot ever be an empty string, and so is always required.
     </dd>
     <dt>
      <tt class="docutils literal">
       SCRIPT_NAME
      </tt>
     </dt>
     <dd>
      The initial portion of the request URL's "path" that corresponds to
the application object, so that the application knows its virtual
"location".  This
      <strong>
       may
      </strong>
      be an empty string, if the application
corresponds to the "root" of the server.
     </dd>
     <dt>
      <tt class="docutils literal">
       PATH_INFO
      </tt>
     </dt>
     <dd>
      The remainder of the request URL's "path", designating the virtual
"location" of the request's target within the application.  This
      <strong>
       may
      </strong>
      be an empty string, if the request URL targets the
application root and does not have a trailing slash.
     </dd>
     <dt>
      <tt class="docutils literal">
       QUERY_STRING
      </tt>
     </dt>
     <dd>
      The portion of the request URL that follows the
      <tt class="docutils literal">
       <span class="pre">
        "?"
       </span>
      </tt>
      , if any.
May be empty or absent.
     </dd>
     <dt>
      <tt class="docutils literal">
       CONTENT_TYPE
      </tt>
     </dt>
     <dd>
      The contents of any
      <tt class="docutils literal">
       <span class="pre">
        Content-Type
       </span>
      </tt>
      fields in the HTTP request.
May be empty or absent.
     </dd>
     <dt>
      <tt class="docutils literal">
       CONTENT_LENGTH
      </tt>
     </dt>
     <dd>
      The contents of any
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      fields in the HTTP request.
May be empty or absent.
     </dd>
     <dt>
      <tt class="docutils literal">
       SERVER_NAME
      </tt>
      ,
      <tt class="docutils literal">
       SERVER_PORT
      </tt>
     </dt>
     <dd>
      When combined with
      <tt class="docutils literal">
       SCRIPT_NAME
      </tt>
      and
      <tt class="docutils literal">
       PATH_INFO
      </tt>
      , these variables
can be used to complete the URL.  Note, however, that
      <tt class="docutils literal">
       HTTP_HOST
      </tt>
      ,
if present, should be used in   preference to
      <tt class="docutils literal">
       SERVER_NAME
      </tt>
      for
reconstructing the request URL.  See the
      <a class="reference internal" href="#url-reconstruction">
       URL Reconstruction
      </a>
      section below for more detail.
      <tt class="docutils literal">
       SERVER_NAME
      </tt>
      and
      <tt class="docutils literal">
       SERVER_PORT
      </tt>
      can never be empty strings, and so are always required.
     </dd>
     <dt>
      <tt class="docutils literal">
       SERVER_PROTOCOL
      </tt>
     </dt>
     <dd>
      The version of the protocol the client used to send the request.
Typically this will be something like
      <tt class="docutils literal">
       "HTTP/1.0"
      </tt>
      or
      <tt class="docutils literal">
       "HTTP/1.1"
      </tt>
      and may be used by the application to determine how to treat any
HTTP request headers.  (This variable should probably be called
      <tt class="docutils literal">
       REQUEST_PROTOCOL
      </tt>
      , since it denotes the protocol used in the
request, and is not necessarily the protocol that will be used in the
server's response.  However, for compatibility with CGI we have to
keep the existing name.)
     </dd>
     <dt>
      <tt class="docutils literal">
       HTTP_
      </tt>
      Variables
     </dt>
     <dd>
      Variables corresponding to the client-supplied HTTP request headers
(i.e., variables whose names begin with
      <tt class="docutils literal">
       "HTTP_"
      </tt>
      ).  The presence or
absence of these variables should correspond with the presence or
absence of the appropriate HTTP header in the request.
     </dd>
    </dl>
    <p>
     A server or gateway
     <strong>
      should
     </strong>
     attempt to provide as many other CGI
variables as are applicable.  In addition, if SSL is in use, the server
or gateway
     <strong>
      should
     </strong>
     also provide as many of the Apache SSL environment
variables
     <a class="footnote-reference" href="#id10" id="id3">
      [5]
     </a>
     as are applicable, such as
     <tt class="docutils literal">
      HTTPS=on
     </tt>
     and
     <tt class="docutils literal">
      SSL_PROTOCOL
     </tt>
     .  Note, however, that an application that uses any CGI
variables other than the ones listed above are necessarily non-portable
to web servers that do not support the relevant extensions.  (For
example, web servers that do not publish files will not be able to
provide a meaningful
     <tt class="docutils literal">
      DOCUMENT_ROOT
     </tt>
     or
     <tt class="docutils literal">
      PATH_TRANSLATED
     </tt>
     .)
    </p>
    <p>
     A WSGI-compliant server or gateway
     <strong>
      should
     </strong>
     document what variables
it provides, along with their definitions as appropriate.  Applications
     <strong>
      should
     </strong>
     check for the presence of any variables they require, and
have a fallback plan in the event such a variable is absent.
    </p>
    <p>
     Note: missing variables (such as
     <tt class="docutils literal">
      REMOTE_USER
     </tt>
     when no
authentication has occurred) should be left out of the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary.  Also note that CGI-defined variables must be strings,
if they are present at all.  It is a violation of this specification
for a CGI variable's value to be of any type other than
     <tt class="docutils literal">
      str
     </tt>
     .
    </p>
    <p>
     In addition to the CGI-defined variables, the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary
     <strong>
      may
     </strong>
     also contain arbitrary operating-system "environment variables",
and
     <strong>
      must
     </strong>
     contain the following WSGI-defined variables:
    </p>
    <table border="1" class="docutils">
     <colgroup>
      <col width="31%">
      </col>
      <col width="69%">
      </col>
     </colgroup>
     <thead valign="bottom">
      <tr>
       <th class="head">
        Variable
       </th>
       <th class="head">
        Value
       </th>
      </tr>
     </thead>
     <tbody valign="top">
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.version
        </tt>
       </td>
       <td>
        The tuple
        <tt class="docutils literal">
         (1, 0)
        </tt>
        , representing WSGI
version 1.0.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.url_scheme
        </tt>
       </td>
       <td>
        A string representing the "scheme" portion of
the URL at which the application is being
invoked.  Normally, this will have the value
        <tt class="docutils literal">
         "http"
        </tt>
        or
        <tt class="docutils literal">
         "https"
        </tt>
        , as appropriate.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.input
        </tt>
       </td>
       <td>
        An input stream (file-like object) from which
the HTTP request body can be read.  (The server
or gateway may perform reads on-demand as
requested by the application, or it may pre-
read the client's request body and buffer it
in-memory or on disk, or use any other
technique for providing such an input stream,
according to its preference.)
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.errors
        </tt>
       </td>
       <td>
        <p class="first">
         An output stream (file-like object) to which
error output can be written, for the purpose of
recording program or other errors in a
standardized and possibly centralized location.
This should be a "text mode" stream; i.e.,
applications should use
         <tt class="docutils literal">
          "\n"
         </tt>
         as a line
ending, and assume that it will be converted to
the correct line ending by the server/gateway.
        </p>
        <p class="last">
         For many servers,
         <tt class="docutils literal">
          wsgi.errors
         </tt>
         will be the
server's main error log. Alternatively, this
may be
         <tt class="docutils literal">
          sys.stderr
         </tt>
         , or a log file of some
sort.  The server's documentation should
include an explanation of how to configure this
or where to find the recorded output.  A server
or gateway may supply different error streams
to different applications, if this is desired.
        </p>
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.multithread
        </tt>
       </td>
       <td>
        This value should evaluate true if the
application object may be simultaneously
invoked by another thread in the same process,
and should evaluate false otherwise.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.multiprocess
        </tt>
       </td>
       <td>
        This value should evaluate true if an
equivalent application object may be
simultaneously invoked by another process,
and should evaluate false otherwise.
       </td>
      </tr>
      <tr>
       <td>
        <tt class="docutils literal">
         wsgi.run_once
        </tt>
       </td>
       <td>
        This value should evaluate true if the server
or gateway expects (but does not guarantee!)
that the application will only be invoked this
one time during the life of its containing
process.  Normally, this will only be true for
a gateway based on CGI (or something similar).
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     Finally, the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary may also contain server-defined
variables.  These variables should be named using only lower-case
letters, numbers, dots, and underscores, and should be prefixed with
a name that is unique to the defining server or gateway.  For
example,
     <tt class="docutils literal">
      mod_python
     </tt>
     might define variables with names like
     <tt class="docutils literal">
      mod_python.some_variable
     </tt>
     .
    </p>
    <div class="section" id="input-and-error-streams">
     <h3>
      <a class="toc-backref" href="#id20">
       Input and Error Streams
      </a>
     </h3>
     <p>
      The input and error streams provided by the server must support
the following methods:
     </p>
     <table border="1" class="docutils">
      <colgroup>
       <col width="51%">
       </col>
       <col width="27%">
       </col>
       <col width="22%">
       </col>
      </colgroup>
      <thead valign="bottom">
       <tr>
        <th class="head">
         Method
        </th>
        <th class="head">
         Stream
        </th>
        <th class="head">
         Notes
        </th>
       </tr>
      </thead>
      <tbody valign="top">
       <tr>
        <td>
         <tt class="docutils literal">
          read(size)
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          input
         </tt>
        </td>
        <td>
         1
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          readline()
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          input
         </tt>
        </td>
        <td>
         1, 2
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          readlines(hint)
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          input
         </tt>
        </td>
        <td>
         1, 3
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          __iter__()
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          input
         </tt>
        </td>
        <td>
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          flush()
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          errors
         </tt>
        </td>
        <td>
         4
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          write(str)
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          errors
         </tt>
        </td>
        <td>
        </td>
       </tr>
       <tr>
        <td>
         <tt class="docutils literal">
          writelines(seq)
         </tt>
        </td>
        <td>
         <tt class="docutils literal">
          errors
         </tt>
        </td>
        <td>
        </td>
       </tr>
      </tbody>
     </table>
     <p>
      The semantics of each method are as documented in the Python Library
Reference, except for these notes as listed in the table above:
     </p>
     <ol class="arabic simple">
      <li>
       The server is not required to read past the client's specified
       <tt class="docutils literal">
        <span class="pre">
         Content-Length
        </span>
       </tt>
       , and is allowed to simulate an end-of-file
condition if the application attempts to read past that point.
The application
       <strong>
        should not
       </strong>
       attempt to read more data than is
specified by the
       <tt class="docutils literal">
        CONTENT_LENGTH
       </tt>
       variable.
      </li>
      <li>
       The optional "size" argument to
       <tt class="docutils literal">
        readline()
       </tt>
       is not supported,
as it may be complex for server authors to implement, and is not
often used in practice.
      </li>
      <li>
       Note that the
       <tt class="docutils literal">
        hint
       </tt>
       argument to
       <tt class="docutils literal">
        readlines()
       </tt>
       is optional for
both caller and implementer.  The application is free not to
supply it, and the server or gateway is free to ignore it.
      </li>
      <li>
       Since the
       <tt class="docutils literal">
        errors
       </tt>
       stream may not be rewound, servers and gateways
are free to forward write operations immediately, without buffering.
In this case, the
       <tt class="docutils literal">
        flush()
       </tt>
       method may be a no-op.  Portable
applications, however, cannot assume that output is unbuffered
or that
       <tt class="docutils literal">
        flush()
       </tt>
       is a no-op.  They must call
       <tt class="docutils literal">
        flush()
       </tt>
       if
they need to ensure that output has in fact been written.  (For
example, to minimize intermingling of data from multiple processes
writing to the same error log.)
      </li>
     </ol>
     <p>
      The methods listed in the table above
      <strong>
       must
      </strong>
      be supported by all
servers conforming to this specification.  Applications conforming
to this specification
      <strong>
       must not
      </strong>
      use any other methods or attributes
of the
      <tt class="docutils literal">
       input
      </tt>
      or
      <tt class="docutils literal">
       errors
      </tt>
      objects.  In particular, applications
      <strong>
       must not
      </strong>
      attempt to close these streams, even if they possess
      <tt class="docutils literal">
       close()
      </tt>
      methods.
     </p>
    </div>
   </div>
   <div class="section" id="the-start-response-callable">
    <h2>
     <a class="toc-backref" href="#id21">
      The
      <tt class="docutils literal">
       start_response()
      </tt>
      Callable
     </a>
    </h2>
    <p>
     The second parameter passed to the application object is a callable
of the form
     <tt class="docutils literal">
      start_response(status, response_headers, exc_info=None)
     </tt>
     .
(As with all WSGI callables, the arguments must be supplied
positionally, not by keyword.)  The
     <tt class="docutils literal">
      start_response
     </tt>
     callable is
used to begin the HTTP response, and it must return a
     <tt class="docutils literal">
      write(body_data)
     </tt>
     callable (see the
     <a class="reference internal" href="#buffering-and-streaming">
      Buffering and Streaming
     </a>
     section, below).
    </p>
    <p>
     The
     <tt class="docutils literal">
      status
     </tt>
     argument is an HTTP "status" string like
     <tt class="docutils literal">
      "200 OK"
     </tt>
     or
     <tt class="docutils literal">
      "404 Not Found"
     </tt>
     .  That is, it is a string consisting of a
Status-Code and a Reason-Phrase, in that order and separated by a
single space, with no surrounding whitespace or other characters.
(See
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     , Section 6.1.1 for more information.)  The string
     <strong>
      must not
     </strong>
     contain control characters, and must not be terminated
with a carriage return, linefeed, or combination thereof.
    </p>
    <p>
     The
     <tt class="docutils literal">
      response_headers
     </tt>
     argument is a list of
     <tt class="docutils literal">
      (header_name,
header_value)
     </tt>
     tuples.  It must be a Python list; i.e.
     <tt class="docutils literal">
      type(response_headers) is ListType
     </tt>
     , and the server
     <strong>
      may
     </strong>
     change
its contents in any way it desires.  Each
     <tt class="docutils literal">
      header_name
     </tt>
     must be a
valid HTTP header field-name (as defined by
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     , Section 4.2),
without a trailing colon or other punctuation.
    </p>
    <p>
     Each
     <tt class="docutils literal">
      header_value
     </tt>
     <strong>
      must not
     </strong>
     include
     <em>
      any
     </em>
     control characters,
including carriage returns or linefeeds, either embedded or at the end.
(These requirements are to minimize the complexity of any parsing that
must be performed by servers, gateways, and intermediate response
processors that need to inspect or modify response headers.)
    </p>
    <p>
     In general, the server or gateway is responsible for ensuring that
correct headers are sent to the client: if the application omits
a header required by HTTP (or other relevant specifications that are in
effect), the server or gateway
     <strong>
      must
     </strong>
     add it.  For example, the HTTP
     <tt class="docutils literal">
      Date:
     </tt>
     and
     <tt class="docutils literal">
      Server:
     </tt>
     headers would normally be supplied by the
server or gateway.
    </p>
    <p>
     (A reminder for server/gateway authors: HTTP header names are
case-insensitive, so be sure to take that into consideration when
examining application-supplied headers!)
    </p>
    <p>
     Applications and middleware are forbidden from using HTTP/1.1
"hop-by-hop" features or headers, any equivalent features in HTTP/1.0,
or any headers that would affect the persistence of the client's
connection to the web server.  These features are the
exclusive province of the actual web server, and a server or gateway
     <strong>
      should
     </strong>
     consider it a fatal error for an application to attempt
sending them, and raise an error if they are supplied to
     <tt class="docutils literal">
      start_response()
     </tt>
     .  (For more specifics on "hop-by-hop" features and
headers, please see the
     <a class="reference internal" href="#other-http-features">
      Other HTTP Features
     </a>
     section below.)
    </p>
    <p>
     The
     <tt class="docutils literal">
      start_response
     </tt>
     callable
     <strong>
      must not
     </strong>
     actually transmit the
response headers.  Instead, it must store them for the server or
gateway to transmit
     <strong>
      only
     </strong>
     after the first iteration of the
application return value that yields a non-empty string, or upon
the application's first invocation of the
     <tt class="docutils literal">
      write()
     </tt>
     callable.  In
other words, response headers must not be sent until there is actual
body data available, or until the application's returned iterable is
exhausted.  (The only possible exception to this rule is if the
response headers explicitly include a
     <tt class="docutils literal">
      <span class="pre">
       Content-Length
      </span>
     </tt>
     of zero.)
    </p>
    <p>
     This delaying of response header transmission is to ensure that buffered
and asynchronous applications can replace their originally intended
output with error output, up until the last possible moment.  For
example, the application may need to change the response status from
"200 OK" to "500 Internal Error", if an error occurs while the body is
being generated within an application buffer.
    </p>
    <p>
     The
     <tt class="docutils literal">
      exc_info
     </tt>
     argument, if supplied, must be a Python
     <tt class="docutils literal">
      sys.exc_info()
     </tt>
     tuple.  This argument should be supplied by the
application only if
     <tt class="docutils literal">
      start_response
     </tt>
     is being called by an error
handler.  If
     <tt class="docutils literal">
      exc_info
     </tt>
     is supplied, and no HTTP headers have been
output yet,
     <tt class="docutils literal">
      start_response
     </tt>
     should replace the currently-stored
HTTP response headers with the newly-supplied ones, thus allowing the
application to "change its mind" about the output when an error has
occurred.
    </p>
    <p>
     However, if
     <tt class="docutils literal">
      exc_info
     </tt>
     is provided, and the HTTP headers have already
been sent,
     <tt class="docutils literal">
      start_response
     </tt>
     <strong>
      must
     </strong>
     raise an error, and
     <strong>
      should
     </strong>
     raise the
     <tt class="docutils literal">
      exc_info
     </tt>
     tuple.  That is:
    </p>
    <pre class="literal-block">
raise exc_info[0], exc_info[1], exc_info[2]
</pre>
    <p>
     This will re-raise the exception trapped by the application, and in
principle should abort the application.  (It is not safe for the
application to attempt error output to the browser once the HTTP
headers have already been sent.)  The application
     <strong>
      must not
     </strong>
     trap
any exceptions raised by
     <tt class="docutils literal">
      start_response
     </tt>
     , if it called
     <tt class="docutils literal">
      start_response
     </tt>
     with
     <tt class="docutils literal">
      exc_info
     </tt>
     .  Instead, it should allow
such exceptions to propagate back to the server or gateway.  See
     <a class="reference internal" href="#error-handling">
      Error Handling
     </a>
     below, for more details.
    </p>
    <p>
     The application
     <strong>
      may
     </strong>
     call
     <tt class="docutils literal">
      start_response
     </tt>
     more than once, if and
only if the
     <tt class="docutils literal">
      exc_info
     </tt>
     argument is provided.  More precisely, it is
a fatal error to call
     <tt class="docutils literal">
      start_response
     </tt>
     without the
     <tt class="docutils literal">
      exc_info
     </tt>
     argument if
     <tt class="docutils literal">
      start_response
     </tt>
     has already been called within the
current invocation of the application.  (See the example CGI
gateway above for an illustration of the correct logic.)
    </p>
    <p>
     Note: servers, gateways, or middleware implementing
     <tt class="docutils literal">
      start_response
     </tt>
     <strong>
      should
     </strong>
     ensure that no reference is held to the
     <tt class="docutils literal">
      exc_info
     </tt>
     parameter beyond the duration of the function's execution, to avoid
creating a circular reference through the traceback and frames
involved.  The simplest way to do this is something like:
    </p>
    <pre class="literal-block">
def start_response(status, response_headers, exc_info=None):
    if exc_info:
         try:
             # do stuff w/exc_info here
         finally:
             exc_info = None    # Avoid circular ref.
</pre>
    <p>
     The example CGI gateway provides another illustration of this
technique.
    </p>
    <div class="section" id="handling-the-content-length-header">
     <h3>
      <a class="toc-backref" href="#id22">
       Handling the
       <tt class="docutils literal">
        <span class="pre">
         Content-Length
        </span>
       </tt>
       Header
      </a>
     </h3>
     <p>
      If the application does not supply a
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      header, a
server or gateway may choose one of several approaches to handling
it.  The simplest of these is to close the client connection when
the response is completed.
     </p>
     <p>
      Under some circumstances, however, the server or gateway may be
able to either generate a
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      header, or at least
avoid the need to close the client connection.  If the application
does
      <em>
       not
      </em>
      call the
      <tt class="docutils literal">
       write()
      </tt>
      callable, and returns an iterable
whose
      <tt class="docutils literal">
       len()
      </tt>
      is 1, then the server can automatically determine
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      by taking the length of the first string yielded
by the iterable.
     </p>
     <p>
      And, if the server and client both support HTTP/1.1 "chunked
encoding"
      <a class="footnote-reference" href="#id8" id="id4">
       [3]
      </a>
      , then the server
      <strong>
       may
      </strong>
      use chunked encoding to send
a chunk for each
      <tt class="docutils literal">
       write()
      </tt>
      call or string yielded by the iterable,
thus generating a
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      header for each chunk.  This
allows the server to keep the client connection alive, if it wishes
to do so.  Note that the server
      <strong>
       must
      </strong>
      comply fully with
      <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
       RFC 2616
      </a>
      when doing this, or else fall back to one of the other strategies for
dealing with the absence of
      <tt class="docutils literal">
       <span class="pre">
        Content-Length
       </span>
      </tt>
      .
     </p>
     <p>
      (Note: applications and middleware
      <strong>
       must not
      </strong>
      apply any kind of
      <tt class="docutils literal">
       <span class="pre">
        Transfer-Encoding
       </span>
      </tt>
      to their output, such as chunking or gzipping;
as "hop-by-hop" operations, these encodings are the province of the
actual web server/gateway.  See
      <a class="reference internal" href="#other-http-features">
       Other HTTP Features
      </a>
      below, for
more details.)
     </p>
    </div>
   </div>
   <div class="section" id="buffering-and-streaming">
    <h2>
     <a class="toc-backref" href="#id23">
      Buffering and Streaming
     </a>
    </h2>
    <p>
     Generally speaking, applications will achieve the best throughput
by buffering their (modestly-sized) output and sending it all at
once.  This is a common approach in existing frameworks such as
Zope: the output is buffered in a StringIO or similar object, then
transmitted all at once, along with the response headers.
    </p>
    <p>
     The corresponding approach in WSGI is for the application to simply
return a single-element iterable (such as a list) containing the
response body as a single string.  This is the recommended approach
for the vast majority of application functions, that render
HTML pages whose text easily fits in memory.
    </p>
    <p>
     For large files, however, or for specialized uses of HTTP streaming
(such as multipart "server push"), an application may need to provide
output in smaller blocks (e.g. to avoid loading a large file into
memory).  It's also sometimes the case that part of a response may
be time-consuming to produce, but it would be useful to send ahead the
portion of the response that precedes it.
    </p>
    <p>
     In these cases, applications will usually return an iterator (often
a generator-iterator) that produces the output in a block-by-block
fashion.  These blocks may be broken to coincide with mulitpart
boundaries (for "server push"), or just before time-consuming
tasks (such as reading another block of an on-disk file).
    </p>
    <p>
     WSGI servers, gateways, and middleware
     <strong>
      must not
     </strong>
     delay the
transmission of any block; they
     <strong>
      must
     </strong>
     either fully transmit
the block to the client, or guarantee that they will continue
transmission even while the application is producing its next block.
A server/gateway or middleware may provide this guarantee in one of
three ways:
    </p>
    <ol class="arabic simple">
     <li>
      Send the entire block to the operating system (and request
that any O/S buffers be flushed) before returning control
to the application, OR
     </li>
     <li>
      Use a different thread to ensure that the block continues
to be transmitted while the application produces the next
block.
     </li>
     <li>
      (Middleware only) send the entire block to its parent
gateway/server
     </li>
    </ol>
    <p>
     By providing this guarantee, WSGI allows applications to ensure
that transmission will not become stalled at an arbitrary point
in their output data.  This is critical for proper functioning
of e.g. multipart "server push" streaming, where data between
multipart boundaries should be transmitted in full to the client.
    </p>
    <div class="section" id="middleware-handling-of-block-boundaries">
     <h3>
      <a class="toc-backref" href="#id24">
       Middleware Handling of Block Boundaries
      </a>
     </h3>
     <p>
      In order to better support asynchronous applications and servers,
middleware components
      <strong>
       must not
      </strong>
      block iteration waiting for
multiple values from an application iterable.  If the middleware
needs to accumulate more data from the application before it can
produce any output, it
      <strong>
       must
      </strong>
      yield an empty string.
     </p>
     <p>
      To put this requirement another way, a middleware component
      <strong>
       must
yield at least one value
      </strong>
      each time its underlying application
yields a value.  If the middleware cannot yield any other value,
it must yield an empty string.
     </p>
     <p>
      This requirement ensures that asynchronous applications and servers
can conspire to reduce the number of threads that are required
to run a given number of application instances simultaneously.
     </p>
     <p>
      Note also that this requirement means that middleware
      <strong>
       must
      </strong>
      return an iterable as soon as its underlying application returns
an iterable.  It is also forbidden for middleware to use the
      <tt class="docutils literal">
       write()
      </tt>
      callable to transmit data that is yielded by an
underlying application.  Middleware may only use their parent
server's
      <tt class="docutils literal">
       write()
      </tt>
      callable to transmit data that the
underlying application sent using a middleware-provided
      <tt class="docutils literal">
       write()
      </tt>
      callable.
     </p>
    </div>
    <div class="section" id="the-write-callable">
     <h3>
      <a class="toc-backref" href="#id25">
       The
       <tt class="docutils literal">
        write()
       </tt>
       Callable
      </a>
     </h3>
     <p>
      Some existing application framework APIs support unbuffered
output in a different manner than WSGI.  Specifically, they
provide a "write" function or method of some kind to write
an unbuffered block of data, or else they provide a buffered
"write" function and a "flush" mechanism to flush the buffer.
     </p>
     <p>
      Unfortunately, such APIs cannot be implemented in terms of
WSGI's "iterable" application return value, unless threads
or other special mechanisms are used.
     </p>
     <p>
      Therefore, to allow these frameworks to continue using an
imperative API, WSGI includes a special
      <tt class="docutils literal">
       write()
      </tt>
      callable,
returned by the
      <tt class="docutils literal">
       start_response
      </tt>
      callable.
     </p>
     <p>
      New WSGI applications and frameworks
      <strong>
       should not
      </strong>
      use the
      <tt class="docutils literal">
       write()
      </tt>
      callable if it is possible to avoid doing so.  The
      <tt class="docutils literal">
       write()
      </tt>
      callable is strictly a hack to support imperative
streaming APIs.  In general, applications should produce their
output via their returned iterable, as this makes it possible
for web servers to interleave other tasks in the same Python thread,
potentially providing better throughput for the server as a whole.
     </p>
     <p>
      The
      <tt class="docutils literal">
       write()
      </tt>
      callable is returned by the
      <tt class="docutils literal">
       start_response()
      </tt>
      callable, and it accepts a single parameter:  a string to be
written as part of the HTTP response body, that is treated exactly
as though it had been yielded by the output iterable.  In other
words, before
      <tt class="docutils literal">
       write()
      </tt>
      returns, it must guarantee that the
passed-in string was either completely sent to the client, or
that it is buffered for transmission while the application
proceeds onward.
     </p>
     <p>
      An application
      <strong>
       must
      </strong>
      return an iterable object, even if it
uses
      <tt class="docutils literal">
       write()
      </tt>
      to produce all or part of its response body.
The returned iterable
      <strong>
       may
      </strong>
      be empty (i.e. yield no non-empty
strings), but if it
      <em>
       does
      </em>
      yield non-empty strings, that output
must be treated normally by the server or gateway (i.e., it must be
sent or queued immediately).  Applications
      <strong>
       must not
      </strong>
      invoke
      <tt class="docutils literal">
       write()
      </tt>
      from within their return iterable, and therefore any
strings yielded by the iterable are transmitted after all strings
passed to
      <tt class="docutils literal">
       write()
      </tt>
      have been sent to the client.
     </p>
    </div>
   </div>
   <div class="section" id="unicode-issues">
    <h2>
     <a class="toc-backref" href="#id26">
      Unicode Issues
     </a>
    </h2>
    <p>
     HTTP does not directly support Unicode, and neither does this
interface.  All encoding/decoding must be handled by the application;
all strings passed to or from the server must be standard Python byte
strings, not Unicode objects.  The result of using a Unicode object
where a string object is required, is undefined.
    </p>
    <p>
     Note also that strings passed to
     <tt class="docutils literal">
      start_response()
     </tt>
     as a status or
as response headers
     <strong>
      must
     </strong>
     follow
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     with respect to encoding.
That is, they must either be ISO-8859-1 characters, or use
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2047.html">
      RFC 2047
     </a>
     MIME encoding.
    </p>
    <p>
     On Python platforms where the
     <tt class="docutils literal">
      str
     </tt>
     or
     <tt class="docutils literal">
      StringType
     </tt>
     type is in
fact Unicode-based (e.g. Jython, IronPython, Python 3000, etc.), all
"strings" referred to in this specification must contain only
code points representable in ISO-8859-1 encoding (
     <tt class="docutils literal">
      \u0000
     </tt>
     through
     <tt class="docutils literal">
      \u00FF
     </tt>
     , inclusive).  It is a fatal error for an application to
supply strings containing any other Unicode character or code point.
Similarly, servers and gateways
     <strong>
      must not
     </strong>
     supply
strings to an application containing any other Unicode characters.
    </p>
    <p>
     Again, all strings referred to in this specification
     <strong>
      must
     </strong>
     be
of type
     <tt class="docutils literal">
      str
     </tt>
     or
     <tt class="docutils literal">
      StringType
     </tt>
     , and
     <strong>
      must not
     </strong>
     be of type
     <tt class="docutils literal">
      unicode
     </tt>
     or
     <tt class="docutils literal">
      UnicodeType
     </tt>
     .  And, even if a given platform allows
for more than 8 bits per character in
     <tt class="docutils literal">
      str
     </tt>
     /
     <tt class="docutils literal">
      StringType
     </tt>
     objects,
only the lower 8 bits may be used, for any value referred to in
this specification as a "string".
    </p>
   </div>
   <div class="section" id="error-handling">
    <h2>
     <a class="toc-backref" href="#id27">
      Error Handling
     </a>
    </h2>
    <p>
     In general, applications
     <strong>
      should
     </strong>
     try to trap their own, internal
errors, and display a helpful message in the browser.  (It is up
to the application to decide what "helpful" means in this context.)
    </p>
    <p>
     However, to display such a message, the application must not have
actually sent any data to the browser yet, or else it risks corrupting
the response.  WSGI therefore provides a mechanism to either allow the
application to send its error message, or be automatically aborted:
the
     <tt class="docutils literal">
      exc_info
     </tt>
     argument to
     <tt class="docutils literal">
      start_response
     </tt>
     .  Here is an example
of its use:
    </p>
    <pre class="literal-block">
try:
    # regular application code here
    status = "200 Froody"
    response_headers = [("content-type", "text/plain")]
    start_response(status, response_headers)
    return ["normal body goes here"]
except:
    # XXX should trap runtime issues like MemoryError, KeyboardInterrupt
    #     in a separate handler before this bare 'except:'...
    status = "500 Oops"
    response_headers = [("content-type", "text/plain")]
    start_response(status, response_headers, sys.exc_info())
    return ["error body goes here"]
</pre>
    <p>
     If no output has been written when an exception occurs, the call to
     <tt class="docutils literal">
      start_response
     </tt>
     will return normally, and the application will
return an error body to be sent to the browser.  However, if any output
has already been sent to the browser,
     <tt class="docutils literal">
      start_response
     </tt>
     will reraise
the provided exception.  This exception
     <strong>
      should not
     </strong>
     be trapped by
the application, and so the application will abort.  The server or
gateway can then trap this (fatal) exception and abort the response.
    </p>
    <p>
     Servers
     <strong>
      should
     </strong>
     trap and log any exception that aborts an
application or the iteration of its return value.  If a partial
response has already been written to the browser when an application
error occurs, the server or gateway
     <strong>
      may
     </strong>
     attempt to add an error
message to the output, if the already-sent headers indicate a
     <tt class="docutils literal">
      text/*
     </tt>
     content type that the server knows how to modify cleanly.
    </p>
    <p>
     Some middleware may wish to provide additional exception handling
services, or intercept and replace application error messages.  In
such cases, middleware may choose to
     <strong>
      not
     </strong>
     re-raise the
     <tt class="docutils literal">
      exc_info
     </tt>
     supplied to
     <tt class="docutils literal">
      start_response
     </tt>
     , but instead raise a middleware-specific
exception, or simply return without an exception after storing the
supplied arguments.  This will then cause the application to return
its error body iterable (or invoke
     <tt class="docutils literal">
      write()
     </tt>
     ), allowing the middleware
to capture and modify the error output.  These techniques will work as
long as application authors:
    </p>
    <ol class="arabic simple">
     <li>
      Always provide
      <tt class="docutils literal">
       exc_info
      </tt>
      when beginning an error response
     </li>
     <li>
      Never trap errors raised by
      <tt class="docutils literal">
       start_response
      </tt>
      when
      <tt class="docutils literal">
       exc_info
      </tt>
      is
being provided
     </li>
    </ol>
   </div>
   <div class="section" id="http-1-1-expect-continue">
    <h2>
     <a class="toc-backref" href="#id28">
      HTTP 1.1 Expect/Continue
     </a>
    </h2>
    <p>
     Servers and gateways that implement HTTP 1.1
     <strong>
      must
     </strong>
     provide
transparent support for HTTP 1.1's "expect/continue" mechanism.  This
may be done in any of several ways:
    </p>
    <ol class="arabic simple">
     <li>
      Respond to requests containing an
      <tt class="docutils literal">
       Expect:
       <span class="pre">
        100-continue
       </span>
      </tt>
      request
with an immediate "100 Continue" response, and proceed normally.
     </li>
     <li>
      Proceed with the request normally, but provide the application
with a
      <tt class="docutils literal">
       wsgi.input
      </tt>
      stream that will send the "100 Continue"
response if/when the application first attempts to read from the
input stream.  The read request must then remain blocked until the
client responds.
     </li>
     <li>
      Wait until the client decides that the server does not support
expect/continue, and sends the request body on its own.  (This
is suboptimal, and is not recommended.)
     </li>
    </ol>
    <p>
     Note that these behavior restrictions do not apply for HTTP 1.0
requests, or for requests that are not directed to an application
object.  For more information on HTTP 1.1 Expect/Continue, see
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC
2616
     </a>
     , sections 8.2.3 and 10.1.1.
    </p>
   </div>
   <div class="section" id="other-http-features">
    <h2>
     <a class="toc-backref" href="#id29">
      Other HTTP Features
     </a>
    </h2>
    <p>
     In general, servers and gateways should "play dumb" and allow the
application complete control over its output.  They should only make
changes that do not alter the effective semantics of the application's
response.  It is always possible for the application developer to add
middleware components to supply additional features, so server/gateway
developers should be conservative in their implementation.  In a sense,
a server should consider itself to be like an HTTP "gateway server",
with the application being an HTTP "origin server".  (See
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     ,
section 1.3, for the definition of these terms.)
    </p>
    <p>
     However, because WSGI servers and applications do not communicate via
HTTP, what
     <a class="reference external" href="http://www.faqs.org/rfcs/rfc2616.html">
      RFC 2616
     </a>
     calls "hop-by-hop" headers do not apply to WSGI
internal communications.  WSGI applications
     <strong>
      must not
     </strong>
     generate any
"hop-by-hop" headers
     <a class="footnote-reference" href="#id9" id="id5">
      [4]
     </a>
     , attempt to use HTTP features that would
require them to generate such headers, or rely on the content of
any incoming "hop-by-hop" headers in the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary.
WSGI servers
     <strong>
      must
     </strong>
     handle any supported inbound "hop-by-hop" headers
on their own, such as by decoding any inbound
     <tt class="docutils literal">
      <span class="pre">
       Transfer-Encoding
      </span>
     </tt>
     ,
including chunked encoding if applicable.
    </p>
    <p>
     Applying these principles to a variety of HTTP features, it should be
clear that a server
     <strong>
      may
     </strong>
     handle cache validation via the
     <tt class="docutils literal">
      <span class="pre">
       If-None-Match
      </span>
     </tt>
     and
     <tt class="docutils literal">
      <span class="pre">
       If-Modified-Since
      </span>
     </tt>
     request headers and the
     <tt class="docutils literal">
      <span class="pre">
       Last-Modified
      </span>
     </tt>
     and
     <tt class="docutils literal">
      ETag
     </tt>
     response headers.  However, it is
not required to do this, and the application
     <strong>
      should
     </strong>
     perform its
own cache validation if it wants to support that feature, since
the server/gateway is not required to do such validation.
    </p>
    <p>
     Similarly, a server
     <strong>
      may
     </strong>
     re-encode or transport-encode an
application's response, but the application
     <strong>
      should
     </strong>
     use a
suitable content encoding on its own, and
     <strong>
      must not
     </strong>
     apply a
transport encoding.  A server
     <strong>
      may
     </strong>
     transmit byte ranges of the
application's response if requested by the client, and the
application doesn't natively support byte ranges.  Again, however,
the application
     <strong>
      should
     </strong>
     perform this function on its own if desired.
    </p>
    <p>
     Note that these restrictions on applications do not necessarily mean
that every application must reimplement every HTTP feature; many HTTP
features can be partially or fully implemented by middleware
components, thus freeing both server and application authors from
implementing the same features over and over again.
    </p>
   </div>
   <div class="section" id="thread-support">
    <h2>
     <a class="toc-backref" href="#id30">
      Thread Support
     </a>
    </h2>
    <p>
     Thread support, or lack thereof, is also server-dependent.
Servers that can run multiple requests in parallel,
     <strong>
      should
     </strong>
     also
provide the option of running an application in a single-threaded
fashion, so that applications or frameworks that are not thread-safe
may still be used with that server.
    </p>
   </div>
  </div>
  <div class="section" id="implementation-application-notes">
   <h1>
    <a class="toc-backref" href="#id31">
     Implementation/Application Notes
    </a>
   </h1>
   <div class="section" id="server-extension-apis">
    <h2>
     <a class="toc-backref" href="#id32">
      Server Extension APIs
     </a>
    </h2>
    <p>
     Some server authors may wish to expose more advanced APIs, that
application or framework authors can use for specialized purposes.
For example, a gateway based on
     <tt class="docutils literal">
      mod_python
     </tt>
     might wish to expose
part of the Apache API as a WSGI extension.
    </p>
    <p>
     In the simplest case, this requires nothing more than defining an
     <tt class="docutils literal">
      environ
     </tt>
     variable, such as
     <tt class="docutils literal">
      mod_python.some_api
     </tt>
     .  But, in many
cases, the possible presence of middleware can make this difficult.
For example, an API that offers access to the same HTTP headers that
are found in
     <tt class="docutils literal">
      environ
     </tt>
     variables, might return different data if
     <tt class="docutils literal">
      environ
     </tt>
     has been modified by middleware.
    </p>
    <p>
     In general, any extension API that duplicates, supplants, or bypasses
some portion of WSGI functionality runs the risk of being incompatible
with middleware components.  Server/gateway developers should
     <em>
      not
     </em>
     assume that nobody will use middleware, because some framework
developers specifically intend to organize or reorganize their
frameworks to function almost entirely as middleware of various kinds.
    </p>
    <p>
     So, to provide maximum compatibility, servers and gateways that
provide extension APIs that replace some WSGI functionality,
     <strong>
      must
     </strong>
     design those APIs so that they are invoked using the portion of the
API that they replace.  For example, an extension API to access HTTP
request headers must require the application to pass in its current
     <tt class="docutils literal">
      environ
     </tt>
     , so that the server/gateway may verify that HTTP headers
accessible via the API have not been altered by middleware.  If the
extension API cannot guarantee that it will always agree with
     <tt class="docutils literal">
      environ
     </tt>
     about the contents of HTTP headers, it must refuse service
to the application, e.g. by raising an error, returning
     <tt class="docutils literal">
      None
     </tt>
     instead of a header collection, or whatever is appropriate to the API.
    </p>
    <p>
     Similarly, if an extension API provides an alternate means of writing
response data or headers, it should require the
     <tt class="docutils literal">
      start_response
     </tt>
     callable to be passed in, before the application can obtain the
extended service.  If the object passed in is not the same one that
the server/gateway originally supplied to the application, it cannot
guarantee correct operation and must refuse to provide the extended
service to the application.
    </p>
    <p>
     These guidelines also apply to middleware that adds information such
as parsed cookies, form variables, sessions, and the like to
     <tt class="docutils literal">
      environ
     </tt>
     .  Specifically, such middleware should provide these
features as functions which operate on
     <tt class="docutils literal">
      environ
     </tt>
     , rather than simply
stuffing values into
     <tt class="docutils literal">
      environ
     </tt>
     .  This helps ensure that information
is calculated from
     <tt class="docutils literal">
      environ
     </tt>
     <em>
      after
     </em>
     any middleware has done any URL
rewrites or other
     <tt class="docutils literal">
      environ
     </tt>
     modifications.
    </p>
    <p>
     It is very important that these "safe extension" rules be followed by
both server/gateway and middleware developers, in order to avoid a
future in which middleware developers are forced to delete any and all
extension APIs from
     <tt class="docutils literal">
      environ
     </tt>
     to ensure that their mediation isn't
being bypassed by applications using those extensions!
    </p>
   </div>
   <div class="section" id="application-configuration">
    <h2>
     <a class="toc-backref" href="#id33">
      Application Configuration
     </a>
    </h2>
    <p>
     This specification does not define how a server selects or obtains an
application to invoke.  These and other configuration options are
highly server-specific matters.  It is expected that server/gateway
authors will document how to configure the server to execute a
particular application object, and with what options (such as
threading options).
    </p>
    <p>
     Framework authors, on the other hand, should document how to create an
application object that wraps their framework's functionality.  The
user, who has chosen both the server and the application framework,
must connect the two together.  However, since both the framework and
the server now have a common interface, this should be merely a
mechanical matter, rather than a significant engineering effort for
each new server/framework pair.
    </p>
    <p>
     Finally, some applications, frameworks, and middleware may wish to
use the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary to receive simple string configuration
options.  Servers and gateways
     <strong>
      should
     </strong>
     support this by allowing
an application's deployer to specify name-value pairs to be placed in
     <tt class="docutils literal">
      environ
     </tt>
     .  In the simplest case, this support can consist merely of
copying all operating system-supplied environment variables from
     <tt class="docutils literal">
      os.environ
     </tt>
     into the
     <tt class="docutils literal">
      environ
     </tt>
     dictionary, since the deployer in
principle can configure these externally to the server, or in the
CGI case they may be able to be set via the server's configuration
files.
    </p>
    <p>
     Applications
     <strong>
      should
     </strong>
     try to keep such required variables to a
minimum, since not all servers will support easy configuration of
them.  Of course, even in the worst case, persons deploying an
application can create a script to supply the necessary configuration
values:
    </p>
    <pre class="literal-block">
from the_app import application

def new_app(environ, start_response):
    environ['the_app.configval1'] = 'something'
    return application(environ, start_response)
</pre>
    <p>
     But, most existing applications and frameworks will probably only need
a single configuration value from
     <tt class="docutils literal">
      environ
     </tt>
     , to indicate the location
of their application or framework-specific configuration file(s).  (Of
course, applications should cache such configuration, to avoid having
to re-read it upon each invocation.)
    </p>
   </div>
   <div class="section" id="url-reconstruction">
    <h2>
     <a class="toc-backref" href="#id34">
      URL Reconstruction
     </a>
    </h2>
    <p>
     If an application wishes to reconstruct a request's complete URL, it
may do so using the following algorithm, contributed by Ian Bicking:
    </p>
    <pre class="literal-block">
from urllib import quote
url = environ['wsgi.url_scheme']+'://'

if environ.get('HTTP_HOST'):
    url += environ['HTTP_HOST']
else:
    url += environ['SERVER_NAME']

    if environ['wsgi.url_scheme'] == 'https':
        if environ['SERVER_PORT'] != '443':
           url += ':' + environ['SERVER_PORT']
    else:
        if environ['SERVER_PORT'] != '80':
           url += ':' + environ['SERVER_PORT']

url += quote(environ.get('SCRIPT_NAME', ''))
url += quote(environ.get('PATH_INFO', ''))
if environ.get('QUERY_STRING'):
    url += '?' + environ['QUERY_STRING']
</pre>
    <p>
     Note that such a reconstructed URL may not be precisely the same URI
as requested by the client.  Server rewrite rules, for example, may
have modified the client's originally requested URL to place it in a
canonical form.
    </p>
   </div>
   <div class="section" id="supporting-older-2-2-versions-of-python">
    <h2>
     <a class="toc-backref" href="#id35">
      Supporting Older (&lt;2.2) Versions of Python
     </a>
    </h2>
    <p>
     Some servers, gateways, or applications may wish to support older
(&lt;2.2) versions of Python.  This is especially important if Jython
is a target platform, since as of this writing a production-ready
version of Jython 2.2 is not yet available.
    </p>
    <p>
     For servers and gateways, this is relatively straightforward:
servers and gateways targeting pre-2.2 versions of Python must
simply restrict themselves to using only a standard "for" loop to
iterate over any iterable returned by an application.  This is the
only way to ensure source-level compatibility with both the pre-2.2
iterator protocol (discussed further below) and "today's" iterator
protocol (see
     <a class="reference external" href="/dev/peps/pep-0234">
      PEP 234
     </a>
     ).
    </p>
    <p>
     (Note that this technique necessarily applies only to servers,
gateways, or middleware that are written in Python.  Discussion of
how to use iterator protocol(s) correctly from other languages is
outside the scope of this PEP.)
    </p>
    <p>
     For applications, supporting pre-2.2 versions of Python is slightly
more complex:
    </p>
    <ul class="simple">
     <li>
      You may not return a file object and expect it to work as an iterable,
since before Python 2.2, files were not iterable.  (In general, you
shouldn't do this anyway, because it will perform quite poorly most
of the time!)  Use
      <tt class="docutils literal">
       wsgi.file_wrapper
      </tt>
      or an application-specific
file wrapper class.  (See
      <a class="reference internal" href="#optional-platform-specific-file-handling">
       Optional Platform-Specific File Handling
      </a>
      for more on
      <tt class="docutils literal">
       wsgi.file_wrapper
      </tt>
      , and an example class you can use
to wrap a file as an iterable.)
     </li>
     <li>
      If you return a custom iterable, it
      <strong>
       must
      </strong>
      implement the pre-2.2
iterator protocol.  That is, provide a
      <tt class="docutils literal">
       __getitem__
      </tt>
      method that
accepts an integer key, and raises
      <tt class="docutils literal">
       IndexError
      </tt>
      when exhausted.
(Note that built-in sequence types are also acceptable, since they
also implement this protocol.)
     </li>
    </ul>
    <p>
     Finally, middleware that wishes to support pre-2.2 versions of Python,
and iterates over application return values or itself returns an
iterable (or both), must follow the appropriate recommendations above.
    </p>
    <p>
     (Note: It should go without saying that to support pre-2.2 versions
of Python, any server, gateway, application, or middleware must also
use only language features available in the target version, use
1 and 0 instead of
     <tt class="docutils literal">
      True
     </tt>
     and
     <tt class="docutils literal">
      False
     </tt>
     , etc.)
    </p>
   </div>
   <div class="section" id="optional-platform-specific-file-handling">
    <h2>
     <a class="toc-backref" href="#id36">
      Optional Platform-Specific File Handling
     </a>
    </h2>
    <p>
     Some operating environments provide special high-performance file-
transmission facilities, such as the Unix
     <tt class="docutils literal">
      sendfile()
     </tt>
     call.
Servers and gateways
     <strong>
      may
     </strong>
     expose this functionality via an optional
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     key in the
     <tt class="docutils literal">
      environ
     </tt>
     .  An application
     <strong>
      may
     </strong>
     use this "file wrapper" to convert a file or file-like object
into an iterable that it then returns, e.g.:
    </p>
    <pre class="literal-block">
if 'wsgi.file_wrapper' in environ:
    return environ['wsgi.file_wrapper'](filelike, block_size)
else:
    return iter(lambda: filelike.read(block_size), '')
</pre>
    <p>
     If the server or gateway supplies
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     , it must be
a callable that accepts one required positional parameter, and one
optional positional parameter.  The first parameter is the file-like
object to be sent, and the second parameter is an optional block
size "suggestion" (which the server/gateway need not use).  The
callable
     <strong>
      must
     </strong>
     return an iterable object, and
     <strong>
      must not
     </strong>
     perform
any data transmission until and unless the server/gateway actually
receives the iterable as a return value from the application.
(To do otherwise would prevent middleware from being able to interpret
or override the response data.)
    </p>
    <p>
     To be considered "file-like", the object supplied by the application
must have a
     <tt class="docutils literal">
      read()
     </tt>
     method that takes an optional size argument.
It
     <strong>
      may
     </strong>
     have a
     <tt class="docutils literal">
      close()
     </tt>
     method, and if so, the iterable returned
by
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     <strong>
      must
     </strong>
     have a
     <tt class="docutils literal">
      close()
     </tt>
     method that
invokes the original file-like object's
     <tt class="docutils literal">
      close()
     </tt>
     method.  If the
"file-like" object has any other methods or attributes with names
matching those of Python built-in file objects (e.g.
     <tt class="docutils literal">
      fileno()
     </tt>
     ),
the
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     <strong>
      may
     </strong>
     assume that these methods or
attributes have the same semantics as those of a built-in file object.
    </p>
    <p>
     The actual implementation of any platform-specific file handling
must occur
     <strong>
      after
     </strong>
     the application returns, and the server or
gateway checks to see if a wrapper object was returned.  (Again,
because of the presence of middleware, error handlers, and the like,
it is not guaranteed that any wrapper created will actually be used.)
    </p>
    <p>
     Apart from the handling of
     <tt class="docutils literal">
      close()
     </tt>
     , the semantics of returning a
file wrapper from the application should be the same as if the
application had returned
     <tt class="docutils literal">
      iter(filelike.read, '')
     </tt>
     .  In other words,
transmission should begin at the current position within the "file"
at the time that transmission begins, and continue until the end is
reached.
    </p>
    <p>
     Of course, platform-specific file transmission APIs don't usually
accept arbitrary "file-like" objects.  Therefore, a
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     has to introspect the supplied object for
things such as a
     <tt class="docutils literal">
      fileno()
     </tt>
     (Unix-like OSes) or a
     <tt class="docutils literal">
      java.nio.FileChannel
     </tt>
     (under Jython) in order to determine if
the file-like object is suitable for use with the platform-specific
API it supports.
    </p>
    <p>
     Note that even if the object is
     <em>
      not
     </em>
     suitable for the platform API,
the
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     <strong>
      must
     </strong>
     still return an iterable that wraps
     <tt class="docutils literal">
      read()
     </tt>
     and
     <tt class="docutils literal">
      close()
     </tt>
     , so that applications using file wrappers
are portable across platforms.  Here's a simple platform-agnostic
file wrapper class, suitable for old (pre 2.2) and new Pythons alike:
    </p>
    <pre class="literal-block">
class FileWrapper:

    def __init__(self, filelike, blksize=8192):
        self.filelike = filelike
        self.blksize = blksize
        if hasattr(filelike, 'close'):
            self.close = filelike.close

    def __getitem__(self, key):
        data = self.filelike.read(self.blksize)
        if data:
            return data
        raise IndexError
</pre>
    <p>
     and here is a snippet from a server/gateway that uses it to provide
access to a platform-specific API:
    </p>
    <pre class="literal-block">
environ['wsgi.file_wrapper'] = FileWrapper
result = application(environ, start_response)

try:
    if isinstance(result, FileWrapper):
        # check if result.filelike is usable w/platform-specific
        # API, and if so, use that API to transmit the result.
        # If not, fall through to normal iterable handling
        # loop below.

    for data in result:
        # etc.

finally:
    if hasattr(result, 'close'):
        result.close()
</pre>
   </div>
  </div>
  <div class="section" id="questions-and-answers">
   <h1>
    <a class="toc-backref" href="#id37">
     Questions and Answers
    </a>
   </h1>
   <ol class="arabic">
    <li>
     <p class="first">
      Why must
      <tt class="docutils literal">
       environ
      </tt>
      be a dictionary?  What's wrong with using a
subclass?
     </p>
     <p>
      The rationale for requiring a dictionary is to maximize portability
between servers.  The alternative would be to define some subset of
a dictionary's methods as being the standard and portable
interface.  In practice, however, most servers will probably find a
dictionary adequate to their needs, and thus framework authors will
come to expect the full set of dictionary features to be available,
since they will be there more often than not.  But, if some server
chooses
      <em>
       not
      </em>
      to use a dictionary, then there will be
interoperability problems despite that server's "conformance" to
spec.  Therefore, making a dictionary mandatory simplifies the
specification and guarantees interoperabilty.
     </p>
     <p>
      Note that this does not prevent server or framework developers from
offering specialized services as custom variables
      <em>
       inside
      </em>
      the
      <tt class="docutils literal">
       environ
      </tt>
      dictionary.  This is the recommended approach for
offering any such value-added services.
     </p>
    </li>
    <li>
     <p class="first">
      Why can you call
      <tt class="docutils literal">
       write()
      </tt>
      <em>
       and
      </em>
      yield strings/return an
iterable?  Shouldn't we pick just one way?
     </p>
     <p>
      If we supported only the iteration approach, then current
frameworks that assume the availability of "push" suffer.  But, if
we only support pushing via
      <tt class="docutils literal">
       write()
      </tt>
      , then server performance
suffers for transmission of e.g. large files (if a worker thread
can't begin work on a new request until all of the output has been
sent).  Thus, this compromise allows an application framework to
support both approaches, as appropriate, but with only a little
more burden to the server implementor than a push-only approach
would require.
     </p>
    </li>
    <li>
     <p class="first">
      What's the
      <tt class="docutils literal">
       close()
      </tt>
      for?
     </p>
     <p>
      When writes are done during the execution of an application
object, the application can ensure that resources are released
using a try/finally block.  But, if the application returns an
iterable, any resources used will not be released until the
iterable is garbage collected.  The
      <tt class="docutils literal">
       close()
      </tt>
      idiom allows an
application to release critical resources at the end of a request,
and it's forward-compatible with the support for try/finally in
generators that's proposed by
      <a class="reference external" href="/dev/peps/pep-0325">
       PEP 325
      </a>
      .
     </p>
    </li>
    <li>
     <p class="first">
      Why is this interface so low-level?  I want feature X!  (e.g.
cookies, sessions, persistence, ...)
     </p>
     <p>
      This isn't Yet Another Python Web Framework.  It's just a way for
frameworks to talk to web servers, and vice versa.  If you want
these features, you need to pick a web framework that provides the
features you want.  And if that framework lets you create a WSGI
application, you should be able to run it in most WSGI-supporting
servers.  Also, some WSGI servers may offer additional services via
objects provided in their
      <tt class="docutils literal">
       environ
      </tt>
      dictionary; see the
applicable server documentation for details.  (Of course,
applications that use such extensions will not be portable to other
WSGI-based servers.)
     </p>
    </li>
    <li>
     <p class="first">
      Why use CGI variables instead of good old HTTP headers?  And why
mix them in with WSGI-defined variables?
     </p>
     <p>
      Many existing web frameworks are built heavily upon the CGI spec,
and existing web servers know how to generate CGI variables.  In
contrast, alternative ways of representing inbound HTTP information
are fragmented and lack market share.  Thus, using the CGI
"standard" seems like a good way to leverage existing
implementations.  As for mixing them with WSGI variables,
separating them would just require two dictionary arguments to be
passed around, while providing no real benefits.
     </p>
    </li>
    <li>
     <p class="first">
      What about the status string?  Can't we just use the number,
passing in
      <tt class="docutils literal">
       200
      </tt>
      instead of
      <tt class="docutils literal">
       "200 OK"
      </tt>
      ?
     </p>
     <p>
      Doing this would complicate the server or gateway, by requiring
them to have a table of numeric statuses and corresponding
messages.  By contrast, it is easy for an application or framework
author to type the extra text to go with the specific response code
they are using, and existing frameworks often already have a table
containing the needed messages.  So, on balance it seems better to
make the application/framework responsible, rather than the server
or gateway.
     </p>
    </li>
    <li>
     <p class="first">
      Why is
      <tt class="docutils literal">
       wsgi.run_once
      </tt>
      not guaranteed to run the app only once?
     </p>
     <p>
      Because it's merely a suggestion to the application that it should
"rig for infrequent running".  This is intended for application
frameworks that have multiple modes of operation for caching,
sessions, and so forth.  In a "multiple run" mode, such frameworks
may preload caches, and may not write e.g. logs or session data to
disk after each request.  In "single run" mode, such frameworks
avoid preloading and flush all necessary writes after each request.
     </p>
     <p>
      However, in order to test an application or framework to verify
correct operation in the latter mode, it may be necessary (or at
least expedient) to invoke it more than once.  Therefore, an
application should not assume that it will definitely not be run
again, just because it is called with
      <tt class="docutils literal">
       wsgi.run_once
      </tt>
      set to
      <tt class="docutils literal">
       True
      </tt>
      .
     </p>
    </li>
    <li>
     <p class="first">
      Feature X (dictionaries, callables, etc.) are ugly for use in
application code; why don't we use objects instead?
     </p>
     <p>
      All of these implementation choices of WSGI are specifically
intended to
      <em>
       decouple
      </em>
      features from one another; recombining these
features into encapsulated objects makes it somewhat harder to
write servers or gateways, and an order of magnitude harder to
write middleware that replaces or modifies only small portions of
the overall functionality.
     </p>
     <p>
      In essence, middleware wants to have a "Chain of Responsibility"
pattern, whereby it can act as a "handler" for some functions,
while allowing others to remain unchanged.  This is difficult to do
with ordinary Python objects, if the interface is to remain
extensible.  For example, one must use
      <tt class="docutils literal">
       __getattr__
      </tt>
      or
      <tt class="docutils literal">
       __getattribute__
      </tt>
      overrides, to ensure that extensions (such as
attributes defined by future WSGI versions) are passed through.
     </p>
     <p>
      This type of code is notoriously difficult to get 100% correct, and
few people will want to write it themselves.  They will therefore
copy other people's implementations, but fail to update them when
the person they copied from corrects yet another corner case.
     </p>
     <p>
      Further, this necessary boilerplate would be pure excise, a
developer tax paid by middleware developers to support a slightly
prettier API for application framework developers.  But,
application framework developers will typically only be updating
      <em>
       one
      </em>
      framework to support WSGI, and in a very limited part of
their framework as a whole.  It will likely be their first (and
maybe their only) WSGI implementation, and thus they will likely
implement with this specification ready to hand.  Thus, the effort
of making the API "prettier" with object attributes and suchlike
would likely be wasted for this audience.
     </p>
     <p>
      We encourage those who want a prettier (or otherwise improved) WSGI
interface for use in direct web application programming (as opposed
to web framework development) to develop APIs or frameworks that
wrap WSGI for convenient use by application developers.  In this
way, WSGI can remain conveniently low-level for server and
middleware authors, while not being "ugly" for application
developers.
     </p>
    </li>
   </ol>
  </div>
  <div class="section" id="proposed-under-discussion">
   <h1>
    <a class="toc-backref" href="#id38">
     Proposed/Under Discussion
    </a>
   </h1>
   <p>
    These items are currently being discussed on the Web-SIG and elsewhere,
or are on the PEP author's "to-do" list:
   </p>
   <ul class="simple">
    <li>
     Should
     <tt class="docutils literal">
      wsgi.input
     </tt>
     be an iterator instead of a file?  This would
help for asynchronous applications and chunked-encoding input
streams.
    </li>
    <li>
     Optional extensions are being discussed for pausing iteration of an
application's output until input is available or until a callback
occurs.
    </li>
    <li>
     Add a section about synchronous vs. asynchronous apps and servers,
the relevant threading models, and issues/design goals in these
areas.
    </li>
   </ul>
  </div>
  <div class="section" id="acknowledgements">
   <h1>
    <a class="toc-backref" href="#id39">
     Acknowledgements
    </a>
   </h1>
   <p>
    Thanks go to the many folks on the Web-SIG mailing list whose
thoughtful feedback made this revised draft possible.  Especially:
   </p>
   <ul class="simple">
    <li>
     Gregory "Grisha" Trubetskoy, author of
     <tt class="docutils literal">
      mod_python
     </tt>
     , who beat up
on the first draft as not offering any advantages over "plain old
CGI", thus encouraging me to look for a better approach.
    </li>
    <li>
     Ian Bicking, who helped nag me into properly specifying the
multithreading and multiprocess options, as well as badgering me to
provide a mechanism for servers to supply custom extension data to
an application.
    </li>
    <li>
     Tony Lownds, who came up with the concept of a
     <tt class="docutils literal">
      start_response
     </tt>
     function that took the status and headers, returning a
     <tt class="docutils literal">
      write
     </tt>
     function.  His input also guided the design of the exception handling
facilities, especially in the area of allowing for middleware that
overrides application error messages.
    </li>
    <li>
     Alan Kennedy, whose courageous attempts to implement WSGI-on-Jython
(well before the spec was finalized) helped to shape the "supporting
older versions of Python" section, as well as the optional
     <tt class="docutils literal">
      wsgi.file_wrapper
     </tt>
     facility.
    </li>
    <li>
     Mark Nottingham, who reviewed the spec extensively for issues with
HTTP RFC compliance, especially with regard to HTTP/1.1 features that
I didn't even know existed until he pointed them out.
    </li>
   </ul>
  </div>
  <div class="section" id="references">
   <h1>
    <a class="toc-backref" href="#id40">
     References
    </a>
   </h1>
   <table class="docutils footnote" frame="void" id="id6" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id1">
        [1]
       </a>
      </td>
      <td>
       The Python Wiki "Web Programming" topic
(
       <a class="reference external" href="http://www.python.org/cgi-bin/moinmoin/WebProgramming">
        http://www.python.org/cgi-bin/moinmoin/WebProgramming
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id7" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id2">
        [2]
       </a>
      </td>
      <td>
       The Common Gateway Interface Specification, v 1.1, 3rd Draft
(
       <a class="reference external" href="http://ken.coar.org/cgi/draft-coar-cgi-v11-03.txt">
        http://ken.coar.org/cgi/draft-coar-cgi-v11-03.txt
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id8" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id4">
        [3]
       </a>
      </td>
      <td>
       "Chunked Transfer Coding" -- HTTP/1.1, section 3.6.1
(
       <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1">
        http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.6.1
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id9" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id5">
        [4]
       </a>
      </td>
      <td>
       "End-to-end and Hop-by-hop Headers" -- HTTP/1.1, Section 13.5.1
(
       <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.5.1">
        http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.5.1
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
   <table class="docutils footnote" frame="void" id="id10" rules="none">
    <colgroup>
     <col class="label">
     </col>
     <col>
     </col>
    </colgroup>
    <tbody valign="top">
     <tr>
      <td class="label">
       <a class="fn-backref" href="#id3">
        [5]
       </a>
      </td>
      <td>
       mod_ssl Reference, "Environment Variables"
(
       <a class="reference external" href="http://www.modssl.org/docs/2.8/ssl_reference.html#ToC25">
        http://www.modssl.org/docs/2.8/ssl_reference.html#ToC25
       </a>
       )
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="section" id="copyright">
   <h1>
    <a class="toc-backref" href="#id41">
     Copyright
    </a>
   </h1>
   <p>
    This document has been placed in the public domain.
   </p>
   <!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 70
End: -->
  </div>
 </body>
</html>Source: <a href="https://hg.python.org/peps/file/tip/pep-0333.txt">https://hg.python.org/peps/file/tip/pep-0333.txt</a>

    </article>


                </section>

                


<aside class="left-sidebar" role="secondary">

    






    





        <div class="twitter-widget sidebar-widget">
        <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/ThePSF" data-widget-id="434113224703610882">Tweets by @ThePSF</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>

    <div class="psf-sidebar-widget sidebar-widget">
        <h3 class="widget-title">The PSF</h3>
<p>The Python Software Foundation is the organization behind Python. Become a member of the PSF and help advance the software and our mission. </p>

    </div>

</aside>



                
                


            </div><!-- end .container -->
        </div><!-- end #content .content-wrapper -->

        <!-- Footer and social media list -->
        <footer id="site-map" class="main-footer" role="contentinfo">
            <div class="main-footer-links">
                <div class="container">

                    
                    <a id="back-to-top-1" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>

                    

<ul class="sitemap navigation menu do-not-print" role="tree">
    
    <li class="tier-1 element-1">
        <a href="/about/" >About</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/about/apps/" title="">Applications</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/about/quotes/" title="">Quotes</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/about/gettingstarted/" title="">Getting Started</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/about/help/" title="">Help</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-2">
        <a href="/downloads/" >Downloads</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/downloads/" title="">All releases</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/downloads/source/" title="">Source code</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/downloads/windows/" title="">Windows</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/downloads/mac-osx/" title="">Mac OS X</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="/download/other/" title="">Other Platforms</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://docs.python.org/3/license.html" title="">License</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="/download/alternatives" title="">Alternative Implementations</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-3">
        <a href="/doc/" >Documentation</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/doc/" title="">Docs</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/doc/av" title="">Audio/Visual Talks</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://wiki.python.org/moin/BeginnersGuide" title="">Beginner&#39;s Guide</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="https://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://docs.python.org/faq/" title="">FAQ</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="http://wiki.python.org/moin/Languages" title="">Non-English Docs</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="http://python.org/dev/peps/" title="">PEP Index</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="https://wiki.python.org/moin/PythonBooks" title="">Python Books</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-4">
        <a href="/community/" >Community</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/community/diversity/" title="">Diversity</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/community/irc/" title="">IRC</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/community/lists/" title="">Mailing Lists</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/community/workshops/" title="">Python Conferences</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="/community/sigs/" title="">Special Interest Groups</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="https://wiki.python.org/moin/" title="">Python Wiki</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="/community/logos/" title="">Python Logo</a></li>
    
        <li class="tier-2 element-8" role="treeitem"><a href="/community/merchandise/" title="">Merchandise</a></li>
    
        <li class="tier-2 element-9" role="treeitem"><a href="/community/awards" title="">Community Awards</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-5">
        <a href="/about/success/" title="success-stories">Success Stories</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/about/success/#arts" title="">Arts</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/about/success/#business" title="">Business</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/about/success/#education" title="">Education</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/about/success/#engineering" title="">Engineering</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="/about/success/#government" title="">Government</a></li>
    
        <li class="tier-2 element-6" role="treeitem"><a href="/about/success/#scientific" title="">Scientific</a></li>
    
        <li class="tier-2 element-7" role="treeitem"><a href="/about/success/#software-development" title="">Software Development</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-6">
        <a href="/blogs/" title="News from around the Python world">News</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/blogs/" title="Python Insider Blog Posts">Python News</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://planetpython.org/" title="Planet Python">Community News</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="http://pyfound.blogspot.com/" title="PSF Blog">PSF News</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pycon.blogspot.com/" title="PyCon Blog">PyCon News</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-7">
        <a href="/events/python-events/" >Events</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="/events/python-events/" title="">Python Events</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="/events/python-user-group/" title="">User Group Events</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="/events/python-events/past/" title="">Python Events Archive</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="/events/python-user-group/past/" title="">User Group Events Archive</a></li>
    
        <li class="tier-2 element-5" role="treeitem"><a href="https://wiki.python.org/moin/PythonEventsCalendar#Submitting_an_Event" title="">Submit an Event</a></li>
    
</ul>

        
    </li>
    
    <li class="tier-1 element-8">
        <a href="/dev/" >Contributing</a>
        
            

<ul class="subnav menu">
    
        <li class="tier-2 element-1" role="treeitem"><a href="http://docs.python.org/devguide/" title="">Developer&#39;s Guide</a></li>
    
        <li class="tier-2 element-2" role="treeitem"><a href="http://bugs.python.org/" title="">Issue Tracker</a></li>
    
        <li class="tier-2 element-3" role="treeitem"><a href="https://mail.python.org/mailman/listinfo/python-dev" title="">python-dev list</a></li>
    
        <li class="tier-2 element-4" role="treeitem"><a href="http://pythonmentors.com/" title="">Core Mentorship</a></li>
    
</ul>

        
    </li>
    
</ul>


                    <a id="back-to-top-2" class="jump-link" href="#python-network"><span aria-hidden="true" class="icon-arrow-up"><span>&#9650;</span></span> Back to Top</a>
                    

                </div><!-- end .container -->
            </div> <!-- end .main-footer-links -->

            <div class="site-base">
                <div class="container">
                    
                    <ul class="footer-links navigation menu do-not-print" role="tree">
                        <li class="tier-1 element-1"><a href="/about/help/">Help &amp; <span class="say-no-more">General</span> Contact</a></li>
                        <li class="tier-1 element-2"><a href="/community/diversity/">Diversity <span class="say-no-more">Initiatives</span></a></li>
                        <li class="tier-1 element-3"><a href="https://github.com/python/pythondotorg/issues">Submit Website Bug</a></li>
                        <!--<li class="tier-1 element-3"><a href="#"><span class="say-no-more">Website</span> Colophon</a></li>-->
                    </ul>

                    <div class="copyright">
                        <p><small>
                            <span class="pre">Copyright &copy;2001-2015.</span>
                            &nbsp;<span class="pre"><a href="/psf-landing/">Python Software Foundation</a></span>
                            &nbsp;<span class="pre"><a href="/about/legal/">Legal Statements</a></span>
                            &nbsp;<span class="pre"><a href="/privacy/">Privacy Policy</a></span>
                        </small></p>
                    </div>

                </div><!-- end .container -->
            </div><!-- end .site-base -->

        </footer>


        <div id="nojs" class="do-not-print">
            <p><strong>Notice:</strong> While Javascript is not essential for this website, your interaction with the content will be limited. Please turn Javascript on for the full experience. </p>
        </div>

        <!--[if lt IE 8]>
        <div id="oldie-warning" class="do-not-print">
            <p><strong>Notice:</strong> Your browser is <em>ancient</em> and <a href="http://www.ie6countdown.com/">Microsoft agrees</a>. <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience a better web.</p>
        </div>
        <![endif]-->

    </div><!-- end #touchnav-wrapper -->

    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/static/js/libs/jquery-1.8.2.min.js"><\/script>')</script>

    <script type="text/javascript" src="/static/js/main-min.js" charset="utf-8"></script>
    

    <!--[if lte IE 7]>
    <script type="text/javascript" src="/static/js/plugins/IE8-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    <!--[if lte IE 8]>
    <script type="text/javascript" src="/static/js/plugins/getComputedStyle-min.js" charset="utf-8"></script>
    
    
    <![endif]-->

    

    
    

</body>
</html>
